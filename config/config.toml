# =============================================================================
# MIETVERWALTUNG - MASTER CONFIGURATION (Konsolidiert & Strukturiert)
# 100% Config-Driven Property Management System
# =============================================================================
# @version: 2.0.0
# @lastModified: 2025-12-20
# @structure: Vollst√§ndig gruppiert mit Inhaltsverzeichnis und Verweisen
# @note: Kataloge bleiben in config/catalogs/
#        Labels, Validation, Design bleiben als Imports
# =============================================================================

# =============================================================================
# üìò INHALTSVERZEICHNIS - Configuration Index
# =============================================================================
# 1. META - Konfigurationsmetadaten (Zeile 44)
# 2. APP - Anwendungseinstellungen (Zeile 55)
# 3. WIDTHS - Standard Spaltenbreiten (Zeile 92)
# 4. BUTTONS - Button-Styling Konfiguration (Zeile 112)
# 5. DESIGN - Schriftarten, Farben & Styling (Zeile 297)
# 6. TABLE - Tabellen-Styling (Zeile 318)
# 7. SERVER - Server-Konfiguration (Zeile 340)
# 8. DATABASE - Datenbank-Einstellungen (Zeile 360)
# 9. NAVIGATION - Navigationsstruktur (Zeile 381)
# 10. ROUTES - API-Routing (Zeile 438)
# 11. PAGINATION - Seitennummerierung (Zeile 446)
# 12. SEARCH - Sucheinstellungen (Zeile 454)
# 13. EXPORT - Export-Einstellungen (Zeile 463)
# 14. NOTIFICATIONS - Benachrichtigungen (Zeile 470)
# 15. AUTOSAVE - Automatisches Speichern (Zeile 478)
# 16. SHORTCUTS - Tastaturk√ºrzel (Zeile 486)
# 17. LOGGING - Logging-Einstellungen (Zeile 493)
# 18. SECURITY - Sicherheitseinstellungen (Zeile 503)
# 19. PERFORMANCE - Performance-Einstellungen (Zeile 513)
# 20. DEBUG - Debug-Einstellungen (Zeile 522)
# 21. ENTITIES - Entity-Definitionen (Zeile 530)
# 22. FORMS - Formular-Definitionen (Zeile 1800)
# 23. TABLES - Tabellen-Definitionen (Zeile 2659)
# 24. VIEWS - View-Definitionen (Zeile 3339)
# =============================================================================

# =============================================================================
# 1. META - Konfigurationsmetadaten
# =============================================================================
[meta]
version = "2.0.0"
schema_version = "2"
last_modified = "2025-12-20"
environment = "development"
config_format = "toml"

# =============================================================================
# 2. APP - Anwendungseinstellungen
# =============================================================================
[app]
name = "Mietverwaltung"
description = "Private Mietobjekt-Verwaltung"
locale = "de-DE"
currency = "EUR"
timezone = "Europe/Berlin"
date_format = "DD.MM.YYYY"
time_format = "HH:mm"
datetime_format = "DD.MM.YYYY HH:mm"

[app.owner]
name = "Akki Scholze"
address = ""
tax_number = ""
email = ""
phone = ""
iban = ""
bic = ""

[app.defaults]
kuendigungsfrist_monate = 3
kaution_monate = 3
nk_abrechnungsfrist_monate = 12
mieterhoehung_sperrfrist_monate = 15
mahnfrist_tage = 14
zahlungsziel_tage = 14

[app.storage]
dokumente_pfad = "./data/dokumente"
backup_pfad = "./data/backups"
temp_pfad = "./data/temp"
max_upload_size_mb = 25
allowed_file_types = ["pdf", "jpg", "jpeg", "png", "doc", "docx", "xls", "xlsx"]

# =============================================================================
# 3. WIDTHS - Standard Spaltenbreiten f√ºr Tabellen (20px Schritte)
# =============================================================================
[widths]
w40 = "40px"
w60 = "60px"
w80 = "80px"
w100 = "100px"
w120 = "120px"
w140 = "140px"
w160 = "160px"
w180 = "180px"
w200 = "200px"
w220 = "220px"
w240 = "240px"
w260 = "260px"
w280 = "280px"
w300 = "300px"
actions = "120px"

# =============================================================================
# 4. BUTTONS - Button-Styling Konfiguration & Universelle Button-Typen
# =============================================================================
[buttons]

# Add Button (Plus Icon)
[buttons.add]
label = "Hinzufuegen"
icon = "Plus"
style = "primary"

# Edit Button (Pencil Icon)
[buttons.edit]
label = "Bearbeiten"
icon = "Pencil"
style = "primary"

# Save Button (Check Icon)
[buttons.save]
label = "Speichern"
icon = "Check"
style = "primary"

# Cancel Button (X Icon)
[buttons.cancel]
label = "Abbrechen"
icon = "X"
style = "secondary"

# Delete Button (Trash2 Icon)
[buttons.delete]
label = "Loeschen"
icon = "Trash2"
style = "danger"

# Confirm Button (Check Icon)
[buttons.confirm]
label = "Bestaetigen"
icon = "Check"
style = "success"

# Close Button (X Icon)
[buttons.close]
label = "Schliessen"
icon = "X"
style = "secondary"

# Back Button (ChevronLeft Icon)
[buttons.back]
label = "Zurueck"
icon = "ChevronLeft"
style = "secondary"

# Reset Button (RotateCcw Icon)
[buttons.reset]
label = "Zuruecksetzen"
icon = "RotateCcw"
style = "secondary"

# Export Button (Download Icon)
[buttons.export]
label = "Exportieren"
icon = "Download"
style = "primary"

# Import Button (Upload Icon)
[buttons.import]
label = "Importieren"
icon = "Upload"
style = "primary"

# Print Button (Printer Icon)
[buttons.print]
label = "Drucken"
icon = "Printer"
style = "primary"

# Search Button (Search Icon)
[buttons.search]
label = "Suchen"
icon = "Search"
style = "primary"

# Help Button (HelpCircle Icon)
[buttons.help]
label = "Hilfe"
icon = "HelpCircle"
style = "secondary"

# Settings Button (Settings Icon)
[buttons.settings]
label = "Einstellungen"
icon = "Settings"
style = "secondary"

# Refresh Button (RefreshCw Icon)
[buttons.refresh]
label = "Aktualisieren"
icon = "RefreshCw"
style = "secondary"

# Next Button (ChevronRight Icon)
[buttons.next]
label = "Weiter"
icon = "ChevronRight"
style = "primary"

# Previous Button (ChevronLeft Icon)
[buttons.previous]
label = "Zurueck"
icon = "ChevronLeft"
style = "secondary"

# Duplicate Button (Copy Icon)
[buttons.duplicate]
label = "Duplizieren"
icon = "Copy"
style = "primary"

# Archive Button (Archive Icon)
[buttons.archive]
label = "Archivieren"
icon = "Archive"
style = "secondary"

# Restore Button (RotateCcw Icon)
[buttons.restore]
label = "Wiederherstellen"
icon = "RotateCcw"
style = "primary"

# Send Button (Send Icon)
[buttons.send]
label = "Versenden"
icon = "Send"
style = "primary"

# Download Button (Download Icon)
[buttons.download]
label = "Herunterladen"
icon = "Download"
style = "primary"

# Upload Button (Upload Icon)
[buttons.upload]
label = "Hochladen"
icon = "Upload"
style = "primary"

# View Button (Eye Icon)
[buttons.view]
label = "Ansehen"
icon = "Eye"
style = "primary"

# Approve Button (Check Icon)
[buttons.approve]
label = "Genehmigen"
icon = "Check"
style = "success"

# Reject Button (X Icon)
[buttons.reject]
label = "Ablehnen"
icon = "X"
style = "danger"

# Move Button (Move Icon)
[buttons.move]
label = "Verschieben"
icon = "Move"
style = "primary"

# Sort Button (ArrowUpDown Icon)
[buttons.sort]
label = "Sortieren"
icon = "ArrowUpDown"
style = "secondary"

# Filter Button (Filter Icon)
[buttons.filter]
label = "Filtern"
icon = "Filter"
style = "primary"

# =============================================================================
# 5. DESIGN - Schriftarten, Farben & Styling-Definitionen
# =============================================================================
[design]

[design.typography]
# Schriftart f√ºr Zahlenfelder (integer, decimal, currency)
numbers_font_family = "font-mono"
numbers_font_class = "font-mono"

# Schriftart f√ºr Text-Felder
text_font_family = "font-sans"
text_font_class = "font-sans"

# Schriftart f√ºr Tabellen-Header
table_header_font = "font-semibold"

# Schriftart f√ºr Tabellen-Daten
table_data_font = "font-sans"
table_data_numbers_font = "font-mono"

# =============================================================================
# 6. TABLE - Tabellen-Styling, Zebrastreifen & Spacing
# =============================================================================
[table]

[table.spacing]
first_column_left = "50px"      # Linker Au√üenabstand erste Spalte
last_column_right = "50px"      # Rechter Au√üenabstand letzte Spalte
column_gap = "8px"              # Abstand zwischen Spalten
column_padding = "px-2"         # Padding in einzelnen Spalten

[table.container]
border = "border border-gray-200"
rounded = "rounded-lg"
overflow = "overflow-hidden"
shadow = "shadow-sm"
background = "bg-white"

[table.scroll]
overflow_x = "overflow-x-auto"
scroll_smooth = "scroll-smooth"

# =============================================================================
# 7. SERVER - Server-Konfiguration
# =============================================================================
[server]
host = "127.0.0.1"
port = 3002
cors_origin = "http://localhost:5174"
request_timeout_ms = 30000
max_request_size = "50mb"

[server.api]
base_path = "/api"
enable_swagger = false
enable_graphql = false

[server.static]
directory = "./public"
cache_control = "public, max-age=3600"
enable_compression = true

# =============================================================================
# 8. DATABASE - Datenbank-Einstellungen
# =============================================================================
[database]
type = "sqlite"
path = "./data/database.sqlite"
wal_mode = true
foreign_keys = true
auto_vacuum = "incremental"
busy_timeout_ms = 5000

[database.migrations]
auto_run = true
directory = "./scripts/migrations"

[database.backup]
enabled = true
schedule = "0 3 * * *"
retention_days = 30
directory = "./data/backups"

# =============================================================================
# 9. NAVIGATION - Navigationsstruktur
# =============================================================================
[navigation]
mode = "sidebar"
position = "left"
collapsible = true
default_collapsed = false

# Navigation.Items
[[navigation.items]]
id = "dashboard"
label = "Dashboard"
route = "/dashboard"
icon = "LayoutDashboard"
order = 10

# Navigation.Items
[[navigation.items]]
id = "objekte"
label = "Objekte/Einheiten"
route = "/objekte"
icon = "Building2"
order = 20

# Navigation.Items
[[navigation.items]]
id = "mieter"
label = "Mieter"
route = "/mieter"
icon = "Users"
order = 30

# Navigation.Items
[[navigation.items]]
id = "vertraege"
label = "Vertraege"
route = "/vertraege"
icon = "FileText"
order = 40

# Navigation.Items
[[navigation.items]]
id = "finanzen"
label = "Finanzen"
route = "/finanzen"
icon = "BarChart3"
order = 50

# Navigation.Items
[[navigation.items]]
id = "nebenkosten"
label = "Nebenkosten"
route = "/nebenkosten"
icon = "Receipt"
order = 60

# =============================================================================
# 10. ROUTES - API-Routing
# =============================================================================
[routes]
base = "/api"
version = "v1"
mobile_readonly = true

# =============================================================================
# 11. PAGINATION - Seitennummerierung
# =============================================================================
[pagination]
default_limit = 100
max_limit = 1000
offset_default = 0

# =============================================================================
# 12. SEARCH - Sucheinstellungen
# =============================================================================
[search]
enabled = true
debounce_ms = 300
min_chars = 2
max_results = 50

# =============================================================================
# 13. EXPORT - Export-Einstellungen
# =============================================================================
[export]
formats = ["pdf", "csv", "xlsx"]
max_records = 10000

# =============================================================================
# 14. NOTIFICATIONS - Benachrichtigungen
# =============================================================================
[notifications]
enabled = true
toast_duration_ms = 3000
sound_enabled = false

# =============================================================================
# 15. AUTOSAVE - Automatisches Speichern
# =============================================================================
[autosave]
enabled = true
interval_ms = 30000
debounce_ms = 500

# =============================================================================
# 16. SHORTCUTS - Tastaturk√ºrzel
# =============================================================================
[shortcuts]
enabled = true
overlay_key = "Shift+?"

# =============================================================================
# 17. LOGGING - Logging-Einstellungen
# =============================================================================
[logging]
level = "info"
format = "json"
output = "console"
max_size_mb = 100
retention_days = 7

# =============================================================================
# 18. SECURITY - Sicherheitseinstellungen
# =============================================================================
[security]
rate_limit_enabled = false
rate_limit_window_ms = 60000
rate_limit_max_requests = 100
csrf_protection = false
sql_injection_prevention = true

# =============================================================================
# 19. PERFORMANCE - Performance-Einstellungen
# =============================================================================
[performance]
cache_enabled = true
cache_ttl_seconds = 3600
compression_enabled = true
query_optimization = true

# =============================================================================
# 20. DEBUG - Debug-Einstellungen
# =============================================================================
[debug]
enabled = false
show_query_time = false
show_render_count = false
log_api_calls = false
mock_delay_ms = 0

# =============================================================================
# 21. ENTITIES - Entity-Definitionen (14 Datenmodelle)
# =============================================================================

# Dokument Entity - Dokumentenverwaltung
[entities.dokument]
name = "dokument"
table_name = "dokumente"
label = "Dokument"
label_plural = "Dokumente"
icon = "File"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.dokument.fields.id]
type = "uuid"
auto_generate = true
visible = false

# objekt_id (UUID)
[entities.dokument.fields.objekt_id]
type = "uuid"
reference = "objekt"
label = "Objekt"

# einheit_id (UUID)
[entities.dokument.fields.einheit_id]
type = "uuid"
reference = "einheit"
label = "Einheit"

# mieter_id (UUID)
[entities.dokument.fields.mieter_id]
type = "uuid"
reference = "mieter"
label = "Mieter"

# vertrag_id (UUID)
[entities.dokument.fields.vertrag_id]
type = "uuid"
reference = "vertrag"
label = "Vertrag"

# typ (Auswahl, erforderlich)
[entities.dokument.fields.typ]
type = "enum"
required = true
options = ["rechnung", "vertrag", "ausweis", "korrespondenz", "foto", "sonstig"]
default = "sonstig"
label = "Typ"

# bezeichnung (Text, erforderlich)
[entities.dokument.fields.bezeichnung]
type = "string"
required = true
max_length = 200
label = "Bezeichnung"

# dateiname (Text, erforderlich)
[entities.dokument.fields.dateiname]
type = "string"
required = true
max_length = 255
label = "Dateiname"

# dateipfad (Text, erforderlich)
[entities.dokument.fields.dateipfad]
type = "string"
required = true
label = "Dateipfad"

# dateigroesse (Ganzzahl)
[entities.dokument.fields.dateigroesse]
type = "integer"
label = "Dateigroesse"

# mime_type (Text)
[entities.dokument.fields.mime_type]
type = "string"
max_length = 100
label = "Mime Type"

# datum (Datum)
[entities.dokument.fields.datum]
type = "date"
label = "Datum"
description = "Dokumentdatum (z.B. Rechnungsdatum)"

# jahr (Ganzzahl)
[entities.dokument.fields.jahr]
type = "integer"
label = "Jahr"
description = "F√ºr Steuerberater-Sortierung"

# hochgeladen_am (Datum & Zeit, auto-generiert)
[entities.dokument.fields.hochgeladen_am]
type = "datetime"
auto_generate = true
label = "Hochgeladen Am"

# Dokument Relations
[entities.dokument.relations]
objekt = { type = "many_to_one", target = "objekt", foreign_key = "objekt_id" }
einheit = { type = "many_to_one", target = "einheit", foreign_key = "einheit_id" }
mieter = { type = "many_to_one", target = "mieter", foreign_key = "mieter_id" }
vertrag = { type = "many_to_one", target = "vertrag", foreign_key = "vertrag_id" }

# Dokument Entity - Dokumentenverwaltung
[entities.dokument.validation]
mindestens_eine_zuordnung = { rule = "objekt_id is not null or mieter_id is not null or vertrag_id is not null", message = "Mindestens eine Zuordnung erforderlich (Objekt oder Mieter oder Vertrag)" }

# Einheit Entity - Mieteinheiten
[entities.einheit]
name = "einheit"
table_name = "einheiten"
label = "Einheit"
label_plural = "Einheiten"
icon = "DoorOpen"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.einheit.fields.id]
type = "uuid"
auto_generate = true
visible = false

# objekt_id (UUID, erforderlich)
[entities.einheit.fields.objekt_id]
type = "uuid"
required = true
reference = "objekt"
label = "Objekt"
placeholder = "Objekt w√§hlen"

# bezeichnung (Text, erforderlich)
[entities.einheit.fields.bezeichnung]
type = "string"
required = true
max_length = 50
label = "Bezeichnung"
placeholder = "z.B. EG links, Halle A"

# typ (Auswahl, erforderlich)
[entities.einheit.fields.typ]
type = "enum"
required = true
options = ["wohnung", "gewerbe", "stellplatz", "keller", "sonstig"]
default = "wohnung"
label = "Typ"
placeholder = "wohnung"

# flaeche (Dezimalzahl, erforderlich)
[entities.einheit.fields.flaeche]
type = "decimal"
required = true
min = 1
precision = 2
suffix = "m¬≤"
label = "Flaeche"
placeholder = "75.0"

# anzahl_raeume (Dezimalzahl)
[entities.einheit.fields.anzahl_raeume]
type = "decimal"
min = 1
precision = 1
label = "Anzahl Raeume"
visible_if = { field = "typ", in = ["wohnung"] }
placeholder = "3.5"

# etage (Text)
[entities.einheit.fields.etage]
type = "string"
max_length = 20
label = "Etage"
placeholder = "z.B. EG, 1. OG, DG"

# ausstattung (multiselect)
[entities.einheit.fields.ausstattung]
type = "multiselect"
options = ["balkon", "terrasse", "keller", "stellplatz", "einbaukueche", "aufzug", "gaeste_wc"]
label = "Ausstattung"
placeholder = "balkon, keller"

# status (Auswahl, erforderlich)
[entities.einheit.fields.status]
type = "enum"
required = true
options = ["vermietet", "leer", "eigennutzung", "renovierung"]
default = "leer"
label = "Status"
placeholder = "leer"

# notiz (Mehrzeiliger Text)
[entities.einheit.fields.notiz]
type = "text"
label = "Notiz"
placeholder = "Besondere Merkmale, Schl√ºssel√ºbergabe"

# Einheit Entity - Mieteinheiten
[entities.einheit.relations]
objekt = { type = "many_to_one", target = "objekt", foreign_key = "objekt_id" }
vertraege = { type = "one_to_many", target = "vertrag", foreign_key = "einheit_id" }
zaehler = { type = "one_to_many", target = "zaehler", foreign_key = "einheit_id" }

# Einheit Entity - Mieteinheiten
[entities.einheit.computed]
aktueller_vertrag = { formula = "first(vertraege where ende is null or ende > now())" }
aktueller_mieter = { formula = "aktueller_vertrag.mieter" }

# Entity: Erinnerung - Datenmodell
[entities.erinnerung]
name = "erinnerung"
table_name = "erinnerungen"
label = "Erinnerung"
label_plural = "Erinnerungen"
icon = "Bell"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.erinnerung.fields.id]
type = "uuid"
auto_generate = true
visible = false

# typ (Auswahl, erforderlich)
[entities.erinnerung.fields.typ]
type = "enum"
required = true
options = ["mieterhoehung", "vertragsende", "zaehlerablesung", "rueckstand", "nk_abrechnung", "kaution_rueckzahlung", "sonstig"]
label = "Typ"

# bezug_typ (Auswahl)
[entities.erinnerung.fields.bezug_typ]
type = "enum"
options = ["vertrag", "objekt", "mieter", "einheit"]
label = "Bezug Typ"

# bezug_id (UUID)
[entities.erinnerung.fields.bezug_id]
type = "uuid"
label = "Bezug Id"

# faellig_am (Datum, erforderlich)
[entities.erinnerung.fields.faellig_am]
type = "date"
required = true
label = "Faellig Am"

# titel (Text, erforderlich)
[entities.erinnerung.fields.titel]
type = "string"
required = true
max_length = 200
label = "Titel"

# beschreibung (Mehrzeiliger Text)
[entities.erinnerung.fields.beschreibung]
type = "text"
label = "Beschreibung"

# status (Auswahl, erforderlich)
[entities.erinnerung.fields.status]
type = "enum"
required = true
options = ["offen", "erledigt", "zurueckgestellt"]
default = "offen"
label = "Status"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.erinnerung.fields.erstellt_am]
type = "datetime"
auto_generate = true
label = "Erstellt Am"

# Kaution Entity - Kautionsverwaltung
[entities.kaution]
name = "kaution"
table_name = "kautionen"
label = "Kaution"
label_plural = "Kautionen"
icon = "Shield"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.kaution.fields.id]
type = "uuid"
auto_generate = true
visible = false

# vertrag_id (UUID, erforderlich)
[entities.kaution.fields.vertrag_id]
type = "uuid"
required = true
unique = true
reference = "vertrag"
label = "Vertrag"

# betrag (W√§hrung ‚Ç¨, erforderlich)
[entities.kaution.fields.betrag]
type = "currency"
required = true
min = 0
label = "Betrag"

# eingangsdatum (Datum, erforderlich)
[entities.kaution.fields.eingangsdatum]
type = "date"
required = true
label = "Eingangsdatum"

# anlageform (Auswahl, erforderlich)
[entities.kaution.fields.anlageform]
type = "enum"
required = true
options = ["sparbuch", "konto", "buergschaft", "bar"]
default = "konto"
label = "Anlageform"

# anlage_details (Mehrzeiliger Text)
[entities.kaution.fields.anlage_details]
type = "text"
label = "Anlage Details"
placeholder = "Bank, Kontonummer, etc."

# zinssatz (Dezimalzahl)
[entities.kaution.fields.zinssatz]
type = "decimal"
min = 0
max = 10
precision = 2
suffix = "%"
label = "Zinssatz"

# status (Auswahl, erforderlich)
[entities.kaution.fields.status]
type = "enum"
required = true
options = ["angelegt", "teilrueckzahlung", "zurueckgezahlt"]
default = "angelegt"
label = "Status"

# rueckzahlungsdatum (Datum)
[entities.kaution.fields.rueckzahlungsdatum]
type = "date"
label = "Rueckzahlungsdatum"
visible_if = { field = "status", in = ["teilrueckzahlung", "zurueckgezahlt"] }

# rueckzahlungsbetrag (W√§hrung ‚Ç¨)
[entities.kaution.fields.rueckzahlungsbetrag]
type = "currency"
min = 0
label = "Rueckzahlungsbetrag"
visible_if = { field = "status", in = ["teilrueckzahlung", "zurueckgezahlt"] }

# einbehalt_grund (Mehrzeiliger Text)
[entities.kaution.fields.einbehalt_grund]
type = "text"
label = "Einbehalt Grund"
visible_if = { field = "status", equals = "teilrueckzahlung" }

# notiz (Mehrzeiliger Text)
[entities.kaution.fields.notiz]
type = "text"
label = "Notiz"

# Kaution Entity - Kautionsverwaltung
[entities.kaution.relations]
vertrag = { type = "one_to_one", target = "vertrag", foreign_key = "vertrag_id" }

# Entity: Kostenart - Datenmodell
[entities.kostenart]
name = "kostenart"
table_name = "kostenarten"
label = "Kostenart"
label_plural = "Kostenarten"
icon = "Tag"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.kostenart.fields.id]
type = "uuid"
auto_generate = true
visible = false

# bezeichnung (Text, erforderlich)
[entities.kostenart.fields.bezeichnung]
type = "string"
required = true
max_length = 100
label = "Bezeichnung"

# kategorie (Auswahl, erforderlich)
[entities.kostenart.fields.kategorie]
type = "enum"
required = true
options = ["umlagefaehig", "nicht_umlagefaehig"]
default = "umlagefaehig"
label = "Kategorie"

# umlageschluessel (Auswahl, erforderlich)
[entities.kostenart.fields.umlageschluessel]
type = "enum"
required = true
options = ["flaeche", "personen", "einheiten", "verbrauch", "direkt"]
default = "flaeche"
label = "Umlageschluessel"
description = "direkt = 1:1 Zuordnung zu Einheit"

# nur_gewerbe (Ja/Nein)
[entities.kostenart.fields.nur_gewerbe]
type = "boolean"
default = false
label = "Nur Gewerbe"

# sortierung (Ganzzahl)
[entities.kostenart.fields.sortierung]
type = "integer"
default = 100
label = "Sortierung"

# aktiv (Ja/Nein)
[entities.kostenart.fields.aktiv]
type = "boolean"
default = true
label = "Aktiv"

# Entities.Kostenart.Relations
[entities.kostenart.relations]
rechnungen = { type = "one_to_many", target = "rechnung", foreign_key = "kostenart_id" }

# Mieter Entity - Mieterstammdaten
[entities.mieter]
name = "mieter"
table_name = "mieter"
label = "Mieter"
label_plural = "Mieter"
icon = "User"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.mieter.fields.id]
type = "uuid"
auto_generate = true
visible = false

# anrede (Auswahl)
[entities.mieter.fields.anrede]
type = "enum"
options = ["herr", "frau", "firma", "divers"]
label = "Anrede"
placeholder = "herr"

# vorname (Text)
[entities.mieter.fields.vorname]
type = "string"
max_length = 50
label = "Vorname"
required_if = { field = "anrede", not_in = ["firma"] }
placeholder = "Max"

# nachname (Text, erforderlich)
[entities.mieter.fields.nachname]
type = "string"
required = true
max_length = 50
label = "Nachname"
description = "Bei Firma: Firmenname"
placeholder = "Mustermann"

# firma_zusatz (Text)
[entities.mieter.fields.firma_zusatz]
type = "string"
max_length = 100
label = "Firmenzusatz"
visible_if = { field = "anrede", equals = "firma" }
placeholder = "Muster GmbH"

# geburtsdatum (Datum)
[entities.mieter.fields.geburtsdatum]
type = "date"
label = "Geburtsdatum"
visible_if = { field = "anrede", not_in = ["firma"] }

# telefon (Text)
[entities.mieter.fields.telefon]
type = "string"
max_length = 30
label = "Telefon"
placeholder = "+49 170 1234567"

# email (E-Mail)
[entities.mieter.fields.email]
type = "email"
max_length = 100
label = "E-Mail"
placeholder = "max@example.com"

# adresse_vorher (Mehrzeiliger Text)
[entities.mieter.fields.adresse_vorher]
type = "text"
label = "Vorherige Adresse"
description = "Vorherige Anschrift"
placeholder = "Musterstra√üe 1, 12345 Berlin"

# iban (Text - Optional, wird nur validiert wenn >2 Zeichen)
[entities.mieter.fields.iban]
type = "string"
required = false
max_length = 34
pattern = "^[A-Z]{2}[0-9]{2}[A-Z0-9]{1,30}$"
label = "IBAN"
default = "DE"
placeholder = "DE12 3456 7890 1234 5678 90"

# bic (Text - Optional)
[entities.mieter.fields.bic]
type = "string"
required = false
max_length = 11
label = "BIC"
placeholder = "COBADEFFXXX"

# bankname (Text - Optional)
[entities.mieter.fields.bankname]
type = "string"
required = false
max_length = 100
label = "Bankname"
placeholder = "Commerzbank K√∂ln"

# status (Auswahl, erforderlich)
[entities.mieter.fields.status]
type = "enum"
required = true
options = ["aktiv", "gekuendigt", "ehemalig"]
default = "aktiv"
label = "Status"
placeholder = "aktiv"

# notiz (Mehrzeiliger Text)
[entities.mieter.fields.notiz]
type = "text"
label = "Notiz"
placeholder = "Hinweise zur Kommunikation"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.mieter.fields.erstellt_am]
type = "datetime"
auto_generate = true
visible_in_form = false
label = "Erstellt Am"

# Mieter Entity - Mieterstammdaten
[entities.mieter.relations]
vertraege = { type = "one_to_many", target = "vertrag", foreign_key = "mieter_id" }
dokumente = { type = "one_to_many", target = "dokument", foreign_key = "mieter_id" }
zahlungen = { type = "one_to_many", target = "zahlung", foreign_key = "mieter_id", through = "vertrag" }

# Mieter Entity - Mieterstammdaten
[entities.mieter.computed]
display_name = { formula = "concat(vorname, ' ', nachname)" }
aktiver_vertrag = { formula = "first(vertraege where ende is null or ende > now())" }
aktuelle_einheit = { formula = "aktiver_vertrag.einheit" }

# Entity: Nebenkostenabrechnung - Datenmodell
[entities.nebenkostenabrechnung]
name = "nebenkostenabrechnung"
table_name = "nebenkostenabrechnungen"
label = "Nebenkostenabrechnung"
label_plural = "Nebenkostenabrechnungen"
icon = "FileSpreadsheet"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.nebenkostenabrechnung.fields.id]
type = "uuid"
auto_generate = true
visible = false

# objekt_id (UUID, erforderlich)
[entities.nebenkostenabrechnung.fields.objekt_id]
type = "uuid"
required = true
reference = "objekt"
label = "Objekt"

# jahr (Ganzzahl, erforderlich)
[entities.nebenkostenabrechnung.fields.jahr]
type = "integer"
required = true
min = 2000
max = 2100
label = "Jahr"

# zeitraum_von (Datum, erforderlich)
[entities.nebenkostenabrechnung.fields.zeitraum_von]
type = "date"
required = true
label = "Zeitraum Von"

# zeitraum_bis (Datum, erforderlich)
[entities.nebenkostenabrechnung.fields.zeitraum_bis]
type = "date"
required = true
label = "Zeitraum Bis"

# status (Auswahl, erforderlich)
[entities.nebenkostenabrechnung.fields.status]
type = "enum"
required = true
options = ["entwurf", "erstellt", "versendet"]
default = "entwurf"
label = "Status"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.nebenkostenabrechnung.fields.erstellt_am]
type = "datetime"
auto_generate = true
label = "Erstellt Am"

# notiz (Mehrzeiliger Text)
[entities.nebenkostenabrechnung.fields.notiz]
type = "text"
label = "Notiz"

# Entities.Nebenkostenabrechnung.Relations
[entities.nebenkostenabrechnung.relations]
objekt = { type = "many_to_one", target = "objekt", foreign_key = "objekt_id" }
positionen = { type = "one_to_many", target = "nebenkostenabrechnung_position", foreign_key = "abrechnung_id" }

# Entities.Nebenkostenabrechnung.Computed
[entities.nebenkostenabrechnung.computed]
gesamtkosten = { formula = "sum(positionen.gesamtkosten)" }

# Objekt Entity - Immobilien
[entities.objekt]
name = "objekt"
table_name = "objekte"
label = "Objekt"
label_plural = "Objekte"
icon = "Building2"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.objekt.fields.id]
type = "uuid"
auto_generate = true
visible = false

# bezeichnung (Text, erforderlich)
[entities.objekt.fields.bezeichnung]
type = "string"
required = true
max_length = 100
label = "Bezeichnung"
placeholder = "z.B. Haus Musterstra√üe 12"

# adresse (Text, erforderlich)
[entities.objekt.fields.adresse]
type = "string"
required = true
max_length = 200
label = "Adresse"

# plz (Text, erforderlich)
[entities.objekt.fields.plz]
type = "string"
required = true
pattern = "^[0-9]{5}$"
label = "Plz"

# ort (Text, erforderlich)
[entities.objekt.fields.ort]
type = "string"
required = true
max_length = 100
label = "Ort"

# baujahr (Ganzzahl)
[entities.objekt.fields.baujahr]
type = "integer"
min = 1800
max = 2100
label = "Baujahr"

# typ (Auswahl, erforderlich)
[entities.objekt.fields.typ]
type = "enum"
required = true
options = ["wohnraum", "gewerbe", "gemischt"]
default = "wohnraum"
label = "Typ"

# ist_multi_einheit (Ja/Nein)
[entities.objekt.fields.ist_multi_einheit]
type = "boolean"
default = false
label = "Ist Multi Einheit"
description = "Mehrere Einheiten mit separaten Z√§hlern"

# notiz (Mehrzeiliger Text)
[entities.objekt.fields.notiz]
type = "text"
label = "Notiz"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.objekt.fields.erstellt_am]
type = "datetime"
auto_generate = true
visible_in_form = false
label = "Erstellt Am"

# Objekt Entity - Immobilien
[entities.objekt.relations]
einheiten = { type = "one_to_many", target = "einheit", foreign_key = "objekt_id" }
zaehler = { type = "one_to_many", target = "zaehler", foreign_key = "objekt_id" }
rechnungen = { type = "one_to_many", target = "rechnung", foreign_key = "objekt_id" }
dokumente = { type = "one_to_many", target = "dokument", foreign_key = "objekt_id" }

# Objekt Entity - Immobilien
[entities.objekt.computed]
anzahl_einheiten = { formula = "count(einheiten)" }
anzahl_vermietet = { formula = "count(einheiten where status = 'vermietet')" }
leerstand = { formula = "anzahl_einheiten - anzahl_vermietet" }
gesamt_flaeche = { formula = "sum(einheiten.flaeche)" }

# Rechnung Entity - Rechnungen
[entities.rechnung]
name = "rechnung"
table_name = "rechnungen"
label = "Rechnung"
label_plural = "Rechnungen"
icon = "Receipt"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.rechnung.fields.id]
type = "uuid"
auto_generate = true
visible = false

# objekt_id (UUID, erforderlich)
[entities.rechnung.fields.objekt_id]
type = "uuid"
required = true
reference = "objekt"
label = "Objekt"

# kostenart_id (UUID, erforderlich)
[entities.rechnung.fields.kostenart_id]
type = "uuid"
required = true
reference = "kostenart"
label = "Kostenart"

# einheit_id (UUID)
[entities.rechnung.fields.einheit_id]
type = "uuid"
reference = "einheit"
label = "Einheit"
description = "Nur bei Direktzuordnung"
visible_if = { field = "kostenart.umlageschluessel", equals = "direkt" }

# rechnungsnummer (Text)
[entities.rechnung.fields.rechnungsnummer]
type = "string"
max_length = 50
label = "Rechnungsnummer"

# rechnungsdatum (Datum, erforderlich)
[entities.rechnung.fields.rechnungsdatum]
type = "date"
required = true
label = "Rechnungsdatum"

# faelligkeitsdatum (Datum)
[entities.rechnung.fields.faelligkeitsdatum]
type = "date"
label = "Faelligkeitsdatum"

# betrag (W√§hrung ‚Ç¨, erforderlich)
[entities.rechnung.fields.betrag]
type = "currency"
required = true
min = 0
label = "Betrag"

# zeitraum_von (Datum)
[entities.rechnung.fields.zeitraum_von]
type = "date"
label = "Zeitraum Von"

# zeitraum_bis (Datum)
[entities.rechnung.fields.zeitraum_bis]
type = "date"
label = "Zeitraum Bis"

# bezahlt_am (Datum)
[entities.rechnung.fields.bezahlt_am]
type = "date"
label = "Bezahlt Am"

# dokument_id (UUID)
[entities.rechnung.fields.dokument_id]
type = "uuid"
reference = "dokument"
label = "Dokument"

# notiz (Mehrzeiliger Text)
[entities.rechnung.fields.notiz]
type = "text"
label = "Notiz"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.rechnung.fields.erstellt_am]
type = "datetime"
auto_generate = true
visible_in_form = false

# Rechnung Entity - Rechnungen
[entities.rechnung.relations]
objekt = { type = "many_to_one", target = "objekt", foreign_key = "objekt_id" }
kostenart = { type = "many_to_one", target = "kostenart", foreign_key = "kostenart_id" }
einheit = { type = "many_to_one", target = "einheit", foreign_key = "einheit_id" }
dokument = { type = "many_to_one", target = "dokument", foreign_key = "dokument_id" }

# Rechnung Entity - Rechnungen
[entities.rechnung.computed]
ist_bezahlt = { formula = "bezahlt_am is not null" }
jahr = { formula = "year(rechnungsdatum)" }

# Sollstellung Entity - Offene Posten
[entities.sollstellung]
name = "sollstellung"
table_name = "sollstellungen"
label = "Sollstellung"
label_plural = "Sollstellungen"
icon = "ListChecks"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.sollstellung.fields.id]
type = "uuid"
auto_generate = true
visible = false

# vertrag_id (UUID, erforderlich)
[entities.sollstellung.fields.vertrag_id]
type = "uuid"
required = true
reference = "vertrag"
label = "Vertrag"

# monat (Text, erforderlich)
[entities.sollstellung.fields.monat]
type = "string"
required = true
pattern = "^[0-9]{4}-[0-9]{2}$"
label = "Monat"

# sollbetrag (W√§hrung ‚Ç¨, erforderlich)
[entities.sollstellung.fields.sollbetrag]
type = "currency"
required = true
label = "Sollbetrag"

# istbetrag (W√§hrung ‚Ç¨)
[entities.sollstellung.fields.istbetrag]
type = "currency"
default = 0
label = "Istbetrag"

# status (Auswahl)
[entities.sollstellung.fields.status]
type = "enum"
options = ["offen", "teilweise", "bezahlt", "ueberzahlt"]
default = "offen"
label = "Status"

# Sollstellung Entity - Offene Posten
[entities.sollstellung.relations]
vertrag = { type = "many_to_one", target = "vertrag", foreign_key = "vertrag_id" }

# Sollstellung Entity - Offene Posten
[entities.sollstellung.computed]
differenz = { formula = "istbetrag - sollbetrag" }
mieter = { formula = "vertrag.mieter" }

# Vertrag Entity - Mietvertr√§ge
[entities.vertrag]
name = "vertrag"
table_name = "vertraege"
label = "Vertrag"
label_plural = "Vertr√§ge"
icon = "FileSignature"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.vertrag.fields.id]
type = "uuid"
auto_generate = true
visible = false

# einheit_id (UUID, erforderlich)
[entities.vertrag.fields.einheit_id]
type = "uuid"
required = true
reference = "einheit"
label = "Einheit"

# mieter_id (UUID, erforderlich)
[entities.vertrag.fields.mieter_id]
type = "uuid"
required = true
reference = "mieter"
label = "Mieter"

# vertragsnummer (Text)
[entities.vertrag.fields.vertragsnummer]
type = "string"
max_length = 30
label = "Vertragsnummer"

# typ (Auswahl, erforderlich)
[entities.vertrag.fields.typ]
type = "enum"
required = true
options = ["wohnraum", "gewerbe"]
label = "Typ"
auto_from = "einheit.objekt.typ"

# beginn (Datum, erforderlich)
[entities.vertrag.fields.beginn]
type = "date"
required = true
label = "Beginn"

# ende (Datum)
[entities.vertrag.fields.ende]
type = "date"
label = "Ende"
description = "Leer = unbefristet"

# kuendigungsfrist (Ganzzahl)
[entities.vertrag.fields.kuendigungsfrist]
type = "integer"
default = 3
min = 1
max = 12
suffix = "Monate"
label = "Kuendigungsfrist"

# kuendigung_zum (Datum)
[entities.vertrag.fields.kuendigung_zum]
type = "date"
label = "Kuendigung Zum"

# gekuendigt_von (Auswahl)
[entities.vertrag.fields.gekuendigt_von]
type = "enum"
options = ["mieter", "vermieter"]
label = "Gekuendigt Von"
visible_if = { field = "kuendigung_zum", is_set = true }

# === Mietkonditionen ===

# kaltmiete (W√§hrung ‚Ç¨, erforderlich)
[entities.vertrag.fields.kaltmiete]
type = "currency"
required = true
min = 0
label = "Kaltmiete"

# nebenkosten_vorauszahlung (W√§hrung ‚Ç¨, erforderlich)
[entities.vertrag.fields.nebenkosten_vorauszahlung]
type = "currency"
required = true
min = 0
default = 0
label = "Nebenkosten Vorauszahlung"

# heizkosten_vorauszahlung (W√§hrung ‚Ç¨)
[entities.vertrag.fields.heizkosten_vorauszahlung]
type = "currency"
min = 0
default = 0
label = "Heizkosten Vorauszahlung"

# sonstige_vorauszahlung (W√§hrung ‚Ç¨)
[entities.vertrag.fields.sonstige_vorauszahlung]
type = "currency"
min = 0
default = 0
label = "Sonstige Vorauszahlung"
description = "z.B. Stellplatz, Garage"

# === Mieterh√∂hung ===

# mietanpassung_typ (Auswahl)
[entities.vertrag.fields.mietanpassung_typ]
type = "enum"
options = ["keine", "mietspiegel", "staffel", "index"]
default = "mietspiegel"
label = "Mietanpassung Typ"
visible_if = { field = "typ", equals = "wohnraum" }

# staffelmiete (json)
[entities.vertrag.fields.staffelmiete]
type = "json"
label = "Staffelmiete"
description = "Array: [{ab: date, kaltmiete: number}]"
visible_if = { field = "mietanpassung_typ", equals = "staffel" }

# indexmiete (json)
[entities.vertrag.fields.indexmiete]
type = "json"
label = "Indexmiete"
description = "{basisjahr, basisindex, schwelle_prozent}"
visible_if = { field = "mietanpassung_typ", equals = "index" }

# letzte_mieterhoehung (Datum)
[entities.vertrag.fields.letzte_mieterhoehung]
type = "date"
label = "Letzte Mieterhoehung"

# notiz (Mehrzeiliger Text)
[entities.vertrag.fields.notiz]
type = "text"
label = "Notiz"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.vertrag.fields.erstellt_am]
type = "datetime"
auto_generate = true
visible_in_form = false

# Vertrag Entity - Mietvertr√§ge
[entities.vertrag.relations]
einheit = { type = "many_to_one", target = "einheit", foreign_key = "einheit_id" }
mieter = { type = "many_to_one", target = "mieter", foreign_key = "mieter_id" }
kaution = { type = "one_to_one", target = "kaution", foreign_key = "vertrag_id" }
zahlungen = { type = "one_to_many", target = "zahlung", foreign_key = "vertrag_id" }
sollstellungen = { type = "one_to_many", target = "sollstellung", foreign_key = "vertrag_id" }

# Vertrag Entity - Mietvertr√§ge
[entities.vertrag.computed]
gesamtmiete = { formula = "kaltmiete + nebenkosten_vorauszahlung + heizkosten_vorauszahlung + sonstige_vorauszahlung" }
ist_aktiv = { formula = "(ende is null or ende > now()) and kuendigung_zum is null" }
ist_gekuendigt = { formula = "kuendigung_zum is not null" }
naechste_mieterhoehung_moeglich = { formula = "add_months(letzte_mieterhoehung, 15)" }

# Vertrag Entity - Mietvertr√§ge
[entities.vertrag.validation]
ende_nach_beginn = { rule = "ende is null or ende > beginn", message = "Ende muss nach Beginn liegen" }
kuendigung_logik = { rule = "kuendigung_zum is null or gekuendigt_von is not null", message = "Bei K√ºndigung fehlt die Angabe wer gek√ºndigt hat" }

# Z√§hler Entity - Z√§hlerdefinitionen
[entities.zaehler]
name = "zaehler"
table_name = "zaehler"
label = "Zaehler"
label_plural = "Z√§hler"
icon = "Gauge"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.zaehler.fields.id]
type = "uuid"
auto_generate = true
visible = false

# objekt_id (UUID, erforderlich)
[entities.zaehler.fields.objekt_id]
type = "uuid"
required = true
reference = "objekt"
label = "Objekt"

# einheit_id (UUID)
[entities.zaehler.fields.einheit_id]
type = "uuid"
reference = "einheit"
label = "Einheit"
description = "Leer = Hauptz√§hler"

# typ (Auswahl, erforderlich)
[entities.zaehler.fields.typ]
type = "enum"
required = true
options = ["strom", "gas", "wasser", "heizung", "warmwasser"]
label = "Typ"

# zaehlernummer (Text, erforderlich)
[entities.zaehler.fields.zaehlernummer]
type = "string"
required = true
max_length = 50
label = "Zaehlernummer"

# ist_hauptzaehler (Ja/Nein)
[entities.zaehler.fields.ist_hauptzaehler]
type = "boolean"
default = false
label = "Ist Hauptzaehler"

# messeinheit (Auswahl, erforderlich)
[entities.zaehler.fields.messeinheit]
type = "enum"
required = true
options = ["kWh", "m3"]
label = "Messeinheit"
auto_from_typ = { strom = "kWh", gas = "m3", wasser = "m3", heizung = "kWh", warmwasser = "m3" }

# notiz (Mehrzeiliger Text)
[entities.zaehler.fields.notiz]
type = "text"
label = "Notiz"

# Z√§hler Entity - Z√§hlerdefinitionen
[entities.zaehler.relations]
objekt = { type = "many_to_one", target = "objekt", foreign_key = "objekt_id" }
einheit = { type = "many_to_one", target = "einheit", foreign_key = "einheit_id" }
staende = { type = "one_to_many", target = "zaehlerstand", foreign_key = "zaehler_id" }

# Z√§hler Entity - Z√§hlerdefinitionen
[entities.zaehler.computed]
letzter_stand = { formula = "last(staende order by datum)" }
bezeichnung_display = { formula = "concat(typ, ' - ', zaehlernummer, ist_hauptzaehler ? ' (Haupt)' : '')" }

# Z√§hlerstand Entity - Z√§hlerst√§nde
[entities.zaehlerstand]
name = "zaehlerstand"
table_name = "zaehlerstaende"
label = "Zaehlerstand"
label_plural = "Z√§hlerst√§nde"
icon = "Activity"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.zaehlerstand.fields.id]
type = "uuid"
auto_generate = true
visible = false

# zaehler_id (UUID, erforderlich)
[entities.zaehlerstand.fields.zaehler_id]
type = "uuid"
required = true
reference = "zaehler"
label = "Zaehler"
visible_in_form = false

# datum (Datum, erforderlich)
[entities.zaehlerstand.fields.datum]
type = "date"
required = true
label = "Datum"

# stand (Dezimalzahl, erforderlich)
[entities.zaehlerstand.fields.stand]
type = "decimal"
required = true
min = 0
precision = 2
label = "Stand"

# ableseart (Auswahl, erforderlich)
[entities.zaehlerstand.fields.ableseart]
type = "enum"
required = true
options = ["selbst", "versorger", "schaetzung"]
default = "selbst"
label = "Ableseart"

# foto (Datei)
[entities.zaehlerstand.fields.foto]
type = "file"
accept = ["image/jpeg", "image/png"]
label = "Foto"

# notiz (Mehrzeiliger Text)
[entities.zaehlerstand.fields.notiz]
type = "text"
label = "Notiz"

# Z√§hlerstand Entity - Z√§hlerst√§nde
[entities.zaehlerstand.relations]
zaehler = { type = "many_to_one", target = "zaehler", foreign_key = "zaehler_id" }

# Z√§hlerstand Entity - Z√§hlerst√§nde
[entities.zaehlerstand.computed]
verbrauch = { formula = "stand - previous(stand)" }

# Zahlung Entity - Zahlungseing√§nge
[entities.zahlung]
name = "zahlung"
table_name = "zahlungen"
label = "Zahlung"
label_plural = "Zahlungen"
icon = "ArrowDownCircle"
primary_key = "id"

# id (UUID, auto-generiert)
[entities.zahlung.fields.id]
type = "uuid"
auto_generate = true
visible = false

# vertrag_id (UUID, erforderlich)
[entities.zahlung.fields.vertrag_id]
type = "uuid"
required = true
reference = "vertrag"
label = "Vertrag"

# datum (Datum, erforderlich)
[entities.zahlung.fields.datum]
type = "date"
required = true
label = "Datum"

# betrag (W√§hrung ‚Ç¨, erforderlich)
[entities.zahlung.fields.betrag]
type = "currency"
required = true
label = "Betrag"

# verwendungszweck (Text)
[entities.zahlung.fields.verwendungszweck]
type = "string"
max_length = 200
label = "Verwendungszweck"

# typ (Auswahl, erforderlich)
[entities.zahlung.fields.typ]
type = "enum"
required = true
options = ["miete", "nachzahlung", "kaution", "sonstig"]
default = "miete"
label = "Typ"

# monat_fuer (Text)
[entities.zahlung.fields.monat_fuer]
type = "string"
pattern = "^[0-9]{4}-[0-9]{2}$"
label = "Monat Fuer"
placeholder = "YYYY-MM"
visible_if = { field = "typ", equals = "miete" }

# notiz (Mehrzeiliger Text)
[entities.zahlung.fields.notiz]
type = "text"
label = "Notiz"

# erstellt_am (Datum & Zeit, auto-generiert)
[entities.zahlung.fields.erstellt_am]
type = "datetime"
auto_generate = true
visible_in_form = false

# Zahlung Entity - Zahlungseing√§nge
[entities.zahlung.relations]
vertrag = { type = "many_to_one", target = "vertrag", foreign_key = "vertrag_id" }

# Zahlung Entity - Zahlungseing√§nge
[entities.zahlung.computed]
mieter = { formula = "vertrag.mieter" }
einheit = { formula = "vertrag.einheit" }

# =============================================================================
# 22. FORMS - Formular-Definitionen (Zeile 3000+)
# =============================================================================

# Dokument Form
[forms.dokument.form]
entity = "dokument"
title_create = "Dokument hochladen"
title_edit = "Dokument bearbeiten"

# Dokument Form - Formular f√ºr Dokumente
[[forms.dokument.form.sections]]
id = "zuordnung"
label = "Zuordnung"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "objekt_id"
  width = "half"
  allow_clear = true

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "einheit_id"
  width = "half"
  allow_clear = true

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "mieter_id"
  width = "half"
  allow_clear = true

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "vertrag_id"
  width = "half"
  allow_clear = true

# Dokument Form - Formular f√ºr Dokumente
[[forms.dokument.form.sections]]
id = "detail"
label = "Details"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "typ"
  width = "half"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "bezeichnung"
  width = "half"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "datum"
  width = "third"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "jahr"
  width = "third"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "hochgeladen_am"
  width = "third"
  readonly = true

# Dokument Form - Formular f√ºr Dokumente
[[forms.dokument.form.sections]]
id = "datei"
label = "Datei"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "dateiname"
  width = "half"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "dateipfad"
  width = "half"
  readonly = true

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "dateigroesse"
  width = "half"
  readonly = true

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "mime_type"
  width = "half"
  readonly = true

# Dokument Form - Formular f√ºr Dokumente
[[forms.dokument.form.sections]]
id = "notiz"

# Dokument Form - Formular f√ºr Dokumente
  [[forms.dokument.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

[forms.dokument.form.actions]
save_label = "Speichern"
cancel_label = "Abbrechen"

# Einheit Form
[forms.einheit.form]
entity = "einheit"
title_create = "Einheit anlegen"
title_edit = "Einheit bearbeiten"

# Einheit Form - Formular f√ºr Einheiten
[[forms.einheit.form.sections]]
id = "basis"
label = "Basis"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "objekt_id"
  width = "full"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "bezeichnung"
  width = "half"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "typ"
  width = "half"

# Einheit Form - Formular f√ºr Einheiten
[[forms.einheit.form.sections]]
id = "details"
label = "Details"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "flaeche"
  width = "half"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "anzahl_raeume"
  width = "half"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "etage"
  placeholder = "2. OG"
  width = "half"

# Einheit Form - Formular f√ºr Einheiten
[[forms.einheit.form.sections]]
id = "ausstattung"
label = "Einstellungen"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "ausstattung"
  width = "full"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "status"
  width = "half"

# Einheit Form - Formular f√ºr Einheiten
[[forms.einheit.form.sections]]
id = "notizen"
label = "Notizen"

# Einheit Form - Formular f√ºr Einheiten
  [[forms.einheit.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

[forms.einheit.form.actions]
submit = "buttons.save"
cancel = "buttons.cancel"

# Kaution Form
[forms.kaution.form]
entity = "kaution"
title_create = "Kaution anlegen"
title_edit = "Kaution bearbeiten"

# Kaution Form - Formular f√ºr Kautionen
[[forms.kaution.form.sections]]
id = "daten"
label = "Allgemein"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "vertrag_id"
  width = "full"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "betrag"
  width = "half"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "eingangsdatum"
  width = "half"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "anlageform"
  width = "full"

# Kaution Form - Formular f√ºr Kautionen
[[forms.kaution.form.sections]]
id = "details"
label = "Kaution"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "anlage_details"
  width = "full"
  rows = 2

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "zinssatz"
  width = "half"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "status"
  width = "half"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "rueckzahlungsdatum"
  width = "half"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "rueckzahlungsbetrag"
  width = "half"

# Kaution Form - Formular f√ºr Kautionen
  [[forms.kaution.form.sections.fields]]
  field = "einbehalt_grund"
  width = "full"
  rows = 2

# Mieter Form
[forms.mieter.form]
entity = "mieter"
title_create = "Mieter anlegen"
title_edit = "Mieter bearbeiten"

# Mieter Form - Formular f√ºr Mieter
[[forms.mieter.form.sections]]
id = "basis"
label = "Basis"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "anrede"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "vorname"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "nachname"
  width = "full"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "firma_zusatz"
  width = "full"

# Mieter Form - Formular f√ºr Mieter
[[forms.mieter.form.sections]]
id = "kontakt"
label = "Kontakt"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "email"
  width = "full"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "telefon"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "mobil"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "status"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
[[forms.mieter.form.sections]]
id = "adressen"
label = "Adressen"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "adresse_vorher"
  width = "full"

# Mieter Form - Formular f√ºr Mieter
[[forms.mieter.form.sections]]
id = "banking"
label = "Finanzen"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "iban"
  width = "full"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "bic"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "bankname"
  width = "half"

# Mieter Form - Formular f√ºr Mieter
[[forms.mieter.form.sections]]
id = "notizen"
label = "Notizen"

# Mieter Form - Formular f√ºr Mieter
  [[forms.mieter.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

[forms.mieter.form.actions]
submit = { label = "Save" }
cancel = { label = "Cancel" }

# Nebenkostenabrechnung Form
[forms.nebenkostenabrechnung.form]
entity = "nebenkostenabrechnung"
title_create = "Nebenkostenabrechnung erstellen"
title_edit = "Nebenkostenabrechnung bearbeiten"

# Nebenkosten-Abrechnung Form
[[forms.nebenkostenabrechnung.form.sections]]
id = "basis"
label = "Nebenkostenabrechnung"

# Nebenkosten-Abrechnung Form
  [[forms.nebenkostenabrechnung.form.sections.fields]]
  field = "objekt_id"
  width = "full"

# Nebenkosten-Abrechnung Form
  [[forms.nebenkostenabrechnung.form.sections.fields]]
  field = "jahr"
  width = "half"

# Nebenkosten-Abrechnung Form
  [[forms.nebenkostenabrechnung.form.sections.fields]]
  field = "zeitraum_von"
  width = "half"

# Nebenkosten-Abrechnung Form
  [[forms.nebenkostenabrechnung.form.sections.fields]]
  field = "zeitraum_bis"
  width = "half"

# Nebenkosten-Abrechnung Form
  [[forms.nebenkostenabrechnung.form.sections.fields]]
  field = "status"
  width = "half"

# Nebenkosten-Abrechnung Form
[[forms.nebenkostenabrechnung.form.sections]]
id = "notiz"
label = "Notizen"

# Nebenkosten-Abrechnung Form
  [[forms.nebenkostenabrechnung.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

# Objekt Form
[forms.objekt.form]
entity = "objekt"
title_create = "Objekt anlegen"
title_edit = "Objekt bearbeiten"

# Objekt Form - Formular f√ºr Objekte
[[forms.objekt.form.sections]]
id = "basis"
label = "Basis"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "bezeichnung"
  width = "full"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "typ"
  width = "half"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "ist_multi_einheit"
  width = "half"

# Objekt Form - Formular f√ºr Objekte
[[forms.objekt.form.sections]]
id = "adresse"
label = "Adresse"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "adresse"
  width = "full"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "plz"
  width = "third"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "ort"
  width = "two_thirds"

# Objekt Form - Formular f√ºr Objekte
[[forms.objekt.form.sections]]
id = "details"
label = "Details"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "baujahr"
  width = "half"

# Objekt Form - Formular f√ºr Objekte
  [[forms.objekt.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

[forms.objekt.form.actions]
submit = "buttons.save"
cancel = "buttons.cancel"

# Rechnung Form
[forms.rechnung.form]
entity = "rechnung"
title_create = "Rechnung erfassen"
title_edit = "Rechnung bearbeiten"

# Rechnung Form - Formular f√ºr Rechnungen
[[forms.rechnung.form.sections]]
id = "metadata"
label = "Rechnung"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "objekt_id"
  width = "full"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "kostenart_id"
  width = "full"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "einheit_id"
  width = "full"

# Rechnung Form - Formular f√ºr Rechnungen
[[forms.rechnung.form.sections]]
id = "zeitr√§ume"
label = "Zeitraum"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "rechnungsnummer"
  width = "half"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "rechnungsdatum"
  width = "half"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "faelligkeitsdatum"
  width = "half"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "zeitraum_von"
  width = "half"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "zeitraum_bis"
  width = "half"

# Rechnung Form - Formular f√ºr Rechnungen
[[forms.rechnung.form.sections]]
id = "betrag"
label = "Betrag"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "betrag"
  width = "half"

# Rechnung Form - Formular f√ºr Rechnungen
  [[forms.rechnung.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

# Sollstellung Form
[forms.sollstellung.form]
entity = "sollstellung"
title_create = "Sollstellung anlegen"
title_edit = "Sollstellung bearbeiten"

# Sollstellung Form - Formular f√ºr Sollstellungen
[[forms.sollstellung.form.sections]]
id = "zeitraum"
label = "Sollstellung"

# Sollstellung Form - Formular f√ºr Sollstellungen
  [[forms.sollstellung.form.sections.fields]]
  field = "vertrag_id"
  width = "full"

# Sollstellung Form - Formular f√ºr Sollstellungen
  [[forms.sollstellung.form.sections.fields]]
  field = "monat"
  width = "half"

# Sollstellung Form - Formular f√ºr Sollstellungen
  [[forms.sollstellung.form.sections.fields]]
  field = "sollbetrag"
  width = "half"

# Sollstellung Form - Formular f√ºr Sollstellungen
  [[forms.sollstellung.form.sections.fields]]
  field = "istbetrag"
  width = "half"

# Sollstellung Form - Formular f√ºr Sollstellungen
  [[forms.sollstellung.form.sections.fields]]
  field = "status"
  width = "half"

# Vertrag Form
[forms.vertrag.form]
entity = "vertrag"
title_create = "Vertrag anlegen"
title_edit = "Vertrag bearbeiten"

# Vertrag Form - Formular f√ºr Vertr√§ge
[[forms.vertrag.form.sections]]
id = "zuordnung"
label = "Zuordnung"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "einheit_id"
  width = "half"
  filter = { status = "leer" }
  include_current = true

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "mieter_id"
  width = "half"
  allow_create = true

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "vertragsnummer"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "typ"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
[[forms.vertrag.form.sections]]
id = "laufzeit"
label = "Laufzeit"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "beginn"
  width = "third"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "ende"
  width = "third"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "kuendigungsfrist"
  width = "third"

# Vertrag Form - Formular f√ºr Vertr√§ge
[[forms.vertrag.form.sections]]
id = "miete"
label = "Miete"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "kaltmiete"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "nebenkosten_vorauszahlung"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "heizkosten_vorauszahlung"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "sonstige_vorauszahlung"
  width = "half"

# Form.Sections.Computed Display
  [form.sections.computed_display]
  field = "computed.gesamtmiete"
  label = "Gesamtmiete"
  format = "currency"
  highlight = true

# Vertrag Form - Formular f√ºr Vertr√§ge
[[forms.vertrag.form.sections]]
id = "anpassung"
label = "Mietenanpassung"
collapsible = true

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "mietanpassung_typ"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "letzte_mieterhoehung"
  width = "half"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "staffelmiete"
  width = "full"
  component = "StaffelmieteEditor"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "indexmiete"
  width = "full"
  component = "IndexmieteEditor"

# Vertrag Form - Formular f√ºr Vertr√§ge
[[forms.vertrag.form.sections]]
id = "sonstiges"

# Vertrag Form - Formular f√ºr Vertr√§ge
  [[forms.vertrag.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

[forms.vertrag.form.on_save]
actions = [
  { action = "update_einheit_status", target = "einheit_id", set = { status = "vermietet" } },
  { action = "update_mieter_status", target = "mieter_id", set = { status = "aktiv" } },
  { action = "generate_sollstellungen", from = "beginn" }
]

# Zaehler Form
[forms.zaehler.form]
entity = "zaehler"
title_create = "Z√§hler anlegen"
title_edit = "Z√§hler bearbeiten"

# Z√§hler Form - Formular f√ºr Z√§hler
[[forms.zaehler.form.sections]]
id = "zuordnung"
label = "Z√§hler-Zuordnung"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "objekt_id"
  width = "full"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "einheit_id"
  width = "full"
  description = "Nur f√ºr Unterz√§hler"

# Z√§hler Form - Formular f√ºr Z√§hler
[[forms.zaehler.form.sections]]
id = "details"
label = "Z√§hlerdetails"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "typ"
  width = "half"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "messeinheit"
  width = "half"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "zaehlernummer"
  width = "half"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "ist_hauptzaehler"
  width = "half"

# Z√§hler Form - Formular f√ºr Z√§hler
[[forms.zaehler.form.sections]]
id = "zusatz"
label = "Z√§hler Zusatz"

# Z√§hler Form - Formular f√ºr Z√§hler
  [[forms.zaehler.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

# Zaehlerstand Form
[forms.zaehlerstand.form]
entity = "zaehlerstand"
title_create = "Z√§hlerstand erfassen"
title_edit = "Z√§hlerstand bearbeiten"

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
[[forms.zaehlerstand.form.sections]]
id = "basis"
label = "Z√§hlerstand"

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
  [[forms.zaehlerstand.form.sections.fields]]
  field = "zaehler_id"
  width = "full"
  hidden = true

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
  [[forms.zaehlerstand.form.sections.fields]]
  field = "datum"
  width = "half"

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
  [[forms.zaehlerstand.form.sections.fields]]
  field = "stand"
  width = "half"

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
  [[forms.zaehlerstand.form.sections.fields]]
  field = "ableseart"
  width = "half"

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
  [[forms.zaehlerstand.form.sections.fields]]
  field = "foto"
  width = "half"

# Z√§hlerstand Form - Formular f√ºr Z√§hlerst√§nde
  [[forms.zaehlerstand.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 3

# Zahlung Form
[forms.zahlung.form]
entity = "zahlung"
title_create = "Zahlung erfassen"
title_edit = "Zahlung bearbeiten"

# Zahlung Form - Formular f√ºr Zahlungen
[[forms.zahlung.form.sections]]
id = "basis"
label = "Zahlung"

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "vertrag_id"
  width = "full"

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "datum"
  width = "half"

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "betrag"
  width = "half"

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "typ"
  width = "half"

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "monat_fuer"
  width = "half"

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "verwendungszweck"
  width = "full"
  rows = 2

# Zahlung Form - Formular f√ºr Zahlungen
  [[forms.zahlung.form.sections.fields]]
  field = "notiz"
  width = "full"
  rows = 2

# =============================================================================
# 23. TABLES - Tabellen-Definitionen (Zeile 3500+)
# =============================================================================

# Abrechnungen Table
[tables.abrechnungen.table]
entity = "nebenkostenabrechnung"

# Table: Abrechnungen - Tabellenkonfiguration
[[tables.abrechnungen.table.columns]]
field = "objekt.bezeichnung"
label = "Objekt"
sortable = true
width = "width.w260"

# Table: Abrechnungen - Tabellenkonfiguration
[[tables.abrechnungen.table.columns]]
field = "jahr"
label = "Jahr"
sortable = true
width = "width.w160"

# Table: Abrechnungen - Tabellenkonfiguration
[[tables.abrechnungen.table.columns]]
field = "zeitraum_von"
label = "Zeitraum"
width = "width.w200"
template = "{zeitraum_von|date} ‚Äì {zeitraum_bis|date}"

# Table: Abrechnungen - Tabellenkonfiguration
[[tables.abrechnungen.table.columns]]
field = "status"
label = "Status"
width = "width.w180"
display = "badge"

# Table: Abrechnungen - Tabellenkonfiguration
[[tables.abrechnungen.table.columns]]
field = "gesamtkosten"
label = "Gesamtkosten"
width = "width.w180"
format = "currency"

[tables.abrechnungen.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.abrechnungen.table.row_actions]
details = { icon = "Search", dialog = "dialogs/nk_abrechnung_detail" }

# Dokumente Table
[tables.dokumente.table]
entity = "dokument"
selectable = true

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "bezeichnung"
label = "Bezeichnung"
sortable = true
width = "width.w300"

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "typ"
label = "Typ"
sortable = true
width = "width.w120"
display = "badge"

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "objekt.bezeichnung"
label = "Objekt"
sortable = true
width = "width.w180"
empty_text = "‚Äî"

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "mieter.computed.display_name"
label = "Mieter"
width = "width.w180"
empty_text = "‚Äî"

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "datum"
label = "Datum"
sortable = true
width = "width.w120"
format = "date"

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "jahr"
label = "Jahr"
sortable = true
width = "width.w100"

# Dokument Table - Tabellenkonfiguration
[[tables.dokumente.table.columns]]
field = "hochgeladen_am"
label = "Hochgeladen"
sortable = true
width = "width.w160"
format = "datetime"

[tables.dokument.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.dokumente.table.row_actions]
preview = { icon = "Eye", handler = "dokument.preview" }
download = { icon = "Download", handler = "dokument.download" }
edit = { icon = "Pencil", dialog = "forms/dokument.form" }
delete = { icon = "Trash2", confirm = true }

# Einheiten Table
[tables.einheiten.table]
entity = "einheit"
row_click = "expand"

# Einheit Table - Tabellenkonfiguration
[[tables.einheiten.table.columns]]
field = "bezeichnung"
label = "Bezeichnung"
sortable = true
width = "width.w300"

# Einheit Table - Tabellenkonfiguration
[[tables.einheiten.table.columns]]
field = "typ"
label = "Typ"
sortable = true
width = "width.w180"
display = "badge"

# Einheit Table - Tabellenkonfiguration
[[tables.einheiten.table.columns]]
field = "flaeche"
label = "Flaeche"
sortable = true
width = "width.w120"
format = "number"
suffix = " m¬≤"

# Einheit Table - Tabellenkonfiguration
[[tables.einheiten.table.columns]]
field = "computed.aktueller_mieter.computed.display_name"
label = "Mieter"
width = "width.w300"
empty_text = "‚Äî"

# Einheit Table - Tabellenkonfiguration
[[tables.einheiten.table.columns]]
field = "status"
label = "Status"
sortable = true
width = "width.w180"
display = "badge"
badge_colors = { vermietet = "green", leer = "red", eigennutzung = "blue", renovierung = "yellow" }

[tables.einheit.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.einheiten.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/einheit.form" }
vertrag = { icon = "FileSignature", dialog = "forms/vertrag.form", visible_if = { field = "status", equals = "leer" }, label = "Vertrag Anlegen" }

# Kautionen Table
[tables.kautionen.table]
entity = "kaution"

# Kaution Table - Tabellenkonfiguration
[[tables.kautionen.table.columns]]
field = "vertrag.mieter.computed.display_name"
label = "Mieter"
sortable = true
width = "width.w300"

# Kaution Table - Tabellenkonfiguration
[[tables.kautionen.table.columns]]
field = "vertrag.einheit.bezeichnung"
label = "Einheit"
sortable = true
width = "width.w260"

# Kaution Table - Tabellenkonfiguration
[[tables.kautionen.table.columns]]
field = "betrag"
label = "Betrag"
sortable = true
width = "width.w180"
format = "currency"

# Kaution Table - Tabellenkonfiguration
[[tables.kautionen.table.columns]]
field = "eingangsdatum"
label = "Eingangsdatum"
sortable = true
width = "width.w180"
format = "date"

# Kaution Table - Tabellenkonfiguration
[[tables.kautionen.table.columns]]
field = "status"
label = "Status"
width = "width.w180"
display = "badge"

# Kaution Table - Tabellenkonfiguration
[[tables.kautionen.table.columns]]
field = "rueckzahlungsdatum"
label = "Rueckzahlungsdatum"
width = "width.w120"
format = "date"

[tables.kautionen.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.kautionen.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/kaution.form" }
delete = { icon = "Trash2", confirm = true }

# Mieter Table
[tables.mieter.table]
entity = "mieter"
row_click = "navigate"
row_click_route = "/mieter/:id"

# Mieter Table - Tabellenkonfiguration
[[tables.mieter.table.columns]]
field = "computed.display_name"
label = "Name"
sortable = true
sort_field = "nachname"
width = "width.w260"
template = "{vorname} {nachname}"

# Mieter Table - Tabellenkonfiguration
[[tables.mieter.table.columns]]
field = "mobil"
fallback_fields = ["telefon"]
label = "Telefon"
width = "width.w160"

# Mieter Table - Tabellenkonfiguration
[[tables.mieter.table.columns]]
field = "email"
label = "Email"
width = "width.w200"

# Mieter Table - Tabellenkonfiguration
[[tables.mieter.table.columns]]
field = "computed.aktuelle_einheit.bezeichnung"
label = "Einheit"
width = "width.w200"
empty_text = "‚Äî"

# Mieter Table - Tabellenkonfiguration
[[tables.mieter.table.columns]]
field = "status"
label = "Status"
sortable = true
width = "width.w100"
display = "badge"
badge_colors = { aktiv = "green", gekuendigt = "yellow", ehemalig = "gray" }

[tables.mieter.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.mieter.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/mieter.form", label = "" }
vertrag = { icon = "FileSignature", label = "", handler = "navigate_vertrag" }
einheit = { icon = "Home", label = "", handler = "navigate_einheit" }

# Objekte Table
[tables.objekte.table]
entity = "objekt"
row_click = "navigate"
row_click_route = "/objekte/:id"

# Objekt Table - Tabellenkonfiguration
[[tables.objekte.table.columns]]
field = "bezeichnung"
label = "Bezeichnung"
sortable = true
width = "width.w300"

# Objekt Table - Tabellenkonfiguration
[[tables.objekte.table.columns]]
field = "adresse"
label = "Adresse"
sortable = true
width = "width.w300"
template = "{adresse}, {plz} {ort}"

# Objekt Table - Tabellenkonfiguration
[[tables.objekte.table.columns]]
field = "typ"
label = "Typ"
sortable = true
width = "width.w120"
display = "badge"
badge_colors = { wohnraum = "blue", gewerbe = "orange", gemischt = "purple" }

# Objekt Table - Tabellenkonfiguration
[[tables.objekte.table.columns]]
field = "computed.anzahl_einheiten"
label = "Einheiten"
sortable = true
width = "width.w120"
align = "center"

# Objekt Table - Tabellenkonfiguration
[[tables.objekte.table.columns]]
field = "computed.leerstand"
label = "Leerstand"
sortable = true
width = "width.w120"
align = "center"
highlight_if = { condition = "> 0", color = "yellow" }

# Objekt Table - Tabellenkonfiguration
[[tables.objekte.table.columns]]
field = "computed.gesamt_flaeche"
label = "Flaeche"
sortable = true
width = "width.w180"
format = "number"
suffix = " m¬≤"

[tables.objekte.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.objekte.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/objekt.form" }
delete = { icon = "Trash2", confirm = true, confirm_message = "Objekt l√∂schen?" }

# Rechnungen Table
[tables.rechnungen.table]
entity = "rechnung"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "rechnungsdatum"
label = "Datum"
sortable = true
width = "width.w120"
format = "date"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "objekt.bezeichnung"
label = "Objekt"
sortable = true
width = "width.w200"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "kostenart.bezeichnung"
label = "Kostenart"
sortable = true
width = "width.w180"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "rechnungsnummer"
label = "Nummer"
width = "width.w160"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "betrag"
label = "Betrag"
sortable = true
width = "width.w160"
format = "currency"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "zeitraum_von"
label = "Zeitraum"
width = "width.w180"
template = "{zeitraum_von|date} - {zeitraum_bis|date}"

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "computed.ist_bezahlt"
label = "Bezahlt"
sortable = true
width = "width.w100"
display = "boolean_icon"
icons = { true = "Check", false = "X" }

# Rechnung Table - Tabellenkonfiguration
[[tables.rechnungen.table.columns]]
field = "dokument_id"
label = ""
width = "width.w60"
display = "icon_link"
icon = "FileText"
visible_if = { field = "dokument_id", is_set = true }
click = "preview_document"

[tables.rechnungen.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.rechnungen.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/rechnung.form" }
bezahlen = { icon = "CheckCircle", handler = "rechnung.markAsPaid", visible_if = { field = "computed.ist_bezahlt", equals = false } }
dokument = { icon = "Upload", dialog = "forms/dokument.form", defaults = { objekt_id = ":objekt_id" } }

# Sollstellungen Table
[tables.sollstellungen.table]
entity = "sollstellung"

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "monat"
label = "Monat"
sortable = true
width = "width.w160"
format = "month"

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "vertrag.mieter.computed.display_name"
label = "Mieter"
sortable = true
width = "22%"

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "vertrag.einheit.bezeichnung"
label = "Einheit"
width = "width.w200"

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "sollbetrag"
label = "Soll"
sortable = true
width = "width.w160"
format = "currency"

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "istbetrag"
label = "Ist"
sortable = true
width = "width.w160"
format = "currency"

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "computed.differenz"
label = "Differenz"
sortable = true
width = "width.w160"
format = "currency"
color_rule = { negative = "red", positive = "green", zero = "inherit" }

# Sollstellung Table - Tabellenkonfiguration
[[tables.sollstellungen.table.columns]]
field = "status"
label = "Status"
sortable = true
width = "width.w160"
display = "badge"
badge_colors = { offen = "red", teilweise = "yellow", bezahlt = "green", ueberzahlt = "blue" }

[tables.sollstellungen.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.sollstellungen.table.row_actions]
zahlung = { icon = "Plus", dialog = "forms/zahlung.form", defaults = { vertrag_id = ":vertrag_id", monat_fuer = ":monat" } }

# Vertraege Table
[tables.vertraege.table]
entity = "vertrag"
row_click = "navigate"
row_click_route = "/vertraege/:id"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "vertragsnummer"
label = "Vertragsnummer"
sortable = true
width = "width.w120"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "mieter.computed.display_name"
label = "Mieter"
sortable = true
width = "width.w260"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "einheit.bezeichnung"
label = "Einheit"
sortable = true
width = "width.w180"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "beginn"
label = "Beginn"
sortable = true
width = "width.w120"
format = "date"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "ende"
label = "Ende"
sortable = true
width = "width.w120"
format = "date"
empty_text = "unbefristet"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "computed.gesamtmiete"
label = "Gesamtmiete"
sortable = true
width = "width.w160"
format = "currency"

# Table: Vertraege - Tabellenkonfiguration
[[tables.vertraege.table.columns]]
field = "computed.ist_aktiv"
label = "Status"
width = "width.w120"
display = "status_indicator"
status_map = { true = { label = "aktiv", color = "green" }, false = { label = "beendet", color = "gray" } }

[tables.vertraege.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.vertraege.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/vertrag.form" }
kuendigen = { icon = "XCircle", dialog = "dialogs/kuendigung", visible_if = { field = "computed.ist_aktiv", equals = true } }

# Zaehler Table
[tables.zaehler.table]
entity = "zaehler"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "objekt.bezeichnung"
label = "Objekt"
sortable = true
width = "width.w260"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "einheit.bezeichnung"
label = "Einheit"
width = "width.w180"
empty_text = "Hauptz√§hler"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "typ"
label = "Typ"
sortable = true
width = "width.w160"
display = "badge"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "zaehlernummer"
label = "Nummer"
width = "width.w180"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "ist_hauptzaehler"
label = "Haupt"
width = "width.w100"
display = "boolean_icon"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "computed.letzter_stand.stand"
label = "Letzter Stand"
width = "width.w180"
template = "{value} {messeinheit}"

# Z√§hler Table - Tabellenkonfiguration
[[tables.zaehler.table.columns]]
field = "computed.letzter_stand.datum"
label = "Abgelesen Am"
sortable = true
width = "width.w180"
format = "date"

[tables.zaehler.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.zaehler.table.row_actions]
ablesung = { icon = "Plus", dialog = "forms/zaehlerstand.form", defaults = { zaehler_id = ":id" } }
edit = { icon = "Pencil", dialog = "forms/zaehler.form" }
historie = { icon = "History", dialog = "dialogs/zaehler_historie" }

# Zahlungen Table
[tables.zahlungen.table]
entity = "zahlung"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "datum"
label = "Datum"
sortable = true
width = "width.w160"
format = "date"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "vertrag.mieter.computed.display_name"
label = "Mieter"
sortable = true
width = "width.w260"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "vertrag.einheit.bezeichnung"
label = "Einheit"
width = "width.w180"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "betrag"
label = "Betrag"
sortable = true
width = "width.w160"
format = "currency"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "typ"
label = "Typ"
sortable = true
width = "width.w160"
display = "badge"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "monat_fuer"
label = "Monat Fuer"
sortable = true
width = "width.w120"
format = "month"

# Zahlung Table - Tabellenkonfiguration
[[tables.zahlungen.table.columns]]
field = "verwendungszweck"
label = "Verwendungszweck"
width = "19%"
truncate = 30

[tables.zahlungen.table.actions]
label = "Aktionen"
width = "width.actions"

[tables.zahlungen.table.row_actions]
edit = { icon = "Pencil", dialog = "forms/zahlung.form" }
delete = { icon = "Trash2", confirm = true }

# =============================================================================
# 24. VIEWS - View-Definitionen (Zeile 4000+)
# =============================================================================

# Views.Dashboard
[views.dashboard]
id = "dashboard"
title = "Dashboard"
route = "/dashboard"
layout = "grid"
grid_cols = { sm = 1, md = 2, lg = 3 }
gap = "gap-6"
padding = "p-6"
background = "bg-transparent"

# Views.Dashboard.Stats Cards
[[views.dashboard.stats_cards]]
id = "objekte"
title = "Objekte"
field = "objekte"
icon = "Building2"
color = "blue"
sortable = true
order = 10

# Views.Dashboard.Stats Cards
[[views.dashboard.stats_cards]]
id = "mieter"
title = "Mieter"
field = "mieter"
icon = "Users"
color = "green"
sortable = true
order = 20

# Views.Dashboard.Stats Cards
[[views.dashboard.stats_cards]]
id = "vertraege"
title = "Vertraege"
field = "vertraege"
icon = "FileText"
color = "purple"
sortable = true
order = 30

# Views.Dashboard.Stats Cards
[[views.dashboard.stats_cards]]
id = "offene_rechnungen"
title = "Offene Rechnungen"
field = "offeneRechnungen"
icon = "Wallet"
color = "orange"
sortable = true
order = 40

# Views.Dashboard.Stats Cards
[[views.dashboard.stats_cards]]
id = "dokumente"
title = "Dokumente"
field = "dokumente"
icon = "FileArchive"
color = "blue"
sortable = true
order = 50

# Views.Dashboard.Stats Cards
[[views.dashboard.stats_cards]]
id = "erinnerungen"
title = "Erinnerungen"
field = "offeneErinnerungen"
icon = "FileCheck"
color = "green"
sortable = true
order = 60

# Views.Dashboard.Cards
[[views.dashboard.cards]]
id = "schnellzugriff"
title = "Schnellzugriff"
subtitle = "Schnellzugriff Desc"
type = "action_buttons"
grid_span = { col = 2, row = 1 }
layout = "flex"
flex_wrap = true
gap = "gap-2"
padding = "p-6"
background = "bg-slate-900"
border = "border border-slate-800"
rounded = "rounded-lg"
shadow = "shadow-lg"

# Views.Dashboard.Cards.Actions
  [[views.dashboard.cards.actions]]
  label = "Btn Dokumente"
  route = "/dokumente"
  icon = "FileText"
  style = "secondary"
  order = 10

# Views.Dashboard.Cards.Actions
  [[views.dashboard.cards.actions]]
  label = "Btn Rechnungen"
  route = "/nebenkosten"
  icon = "Receipt"
  style = "secondary"
  order = 20

# Views.Dashboard.Cards.Actions
  [[views.dashboard.cards.actions]]
  label = "Btn Abrechnungen"
  route = "/nebenkosten"
  icon = "BarChart3"
  style = "secondary"
  order = 30

# Views.Dashboard.Cards.Actions
  [[views.dashboard.cards.actions]]
  label = "Btn Steuerberater Export"
  api_endpoint = "/api/export/steuerberater"
  icon = "Download"
  style = "success"
  download = true
  order = 40

# Views.Dashboard.Cards
[[views.dashboard.cards]]
id = "status"
title = "Status"
type = "status_summary"
grid_span = { col = 1, row = 1 }
padding = "p-6"
background = "bg-slate-900"
border = "border border-slate-800"
rounded = "rounded-lg"
shadow = "shadow-lg"

# Views.Dashboard.Styling
[views.dashboard.styling]
card_bg = "bg-slate-900"
card_border = "border border-slate-800"
card_rounded = "rounded-lg"
card_shadow = "shadow-lg shadow-black/30"
card_padding = "p-6"

stats_card_border = "border border-slate-800"
stats_card_rounded = "rounded-lg"
stats_card_padding = "p-6"
stats_card_shadow = "shadow-lg shadow-black/30"

color_schemes = { blue = "bg-blue-900/40 text-blue-100 border-blue-800", green = "bg-emerald-900/40 text-emerald-100 border-emerald-800", purple = "bg-purple-900/40 text-purple-100 border-purple-800", orange = "bg-amber-900/40 text-amber-100 border-amber-800" }

# Views.Dokumente
[views.dokumente]
id = "dokumente"
title = "Dokumente"
route = "/dokumente"
layout = "single"

# Views.Dokumente.Content
[views.dokumente.content]
table = "tables/dokumente.table"
default_sort = { field = "hochgeladen_am", direction = "desc" }

# View.Content.Filters
  [[view.content.filters]]
  field = "objekt_id"
  type = "select"
  label = "Objekt"
  options_from = "objekt"

# View.Content.Filters
  [[view.content.filters]]
  field = "typ"
  type = "select"
  label = "Typ"

# View.Content.Filters
  [[view.content.filters]]
  field = "jahr"
  type = "year_picker"
  label = "Jahr"

# Views.Dokumente.Content.Actions
[views.dokumente.content.actions]
upload = { label = "Dokument Hochladen", dialog = "forms/dokument.form" }

# Views.Dokumente.Content.Bulk Actions
[views.dokumente.content.bulk_actions]
export = { label = "Steuerberater Export", dialog = "dialogs/steuerberater_export" }
delete = { label = "Loeschen", confirm = true }

# Views.Einstellungen
[views.einstellungen]
id = "einstellungen"
title = "Einstellungen"
route = "/einstellungen"
layout = "settings"

# View.Sections
  [[view.sections]]
  id = "eigentuemer"
  label = "Eigent√ºmer"
  icon = "User"
  form = "forms/eigentuemer.form"
  description = "Eigent√ºmerdaten verwalten"

# View.Sections
  [[view.sections]]
  id = "kostenarten"
  label = "Kostenarten"
  icon = "Tag"
  type = "table_editable"
  table = "tables/kostenarten.table"
  form = "forms/kostenart.form"
  description = "Kostenarten verwalten"

# View.Sections
  [[view.sections]]
  id = "umlageschluessel"
  label = "Umlageschl√ºssel"
  icon = "Percent"
  type = "info"
  content = "catalogs/umlageschluessel.catalog"
  description = "Umlageschl√ºssel konfigurieren"

# View.Sections
  [[view.sections]]
  id = "backup"
  label = "Backup"
  icon = "Database"
  type = "actions"
  description = "Backups erstellen und wiederherstellen"

# View.Sections.Actions
    [[view.sections.actions]]
    id = "backup_create"
    label = "Backup Erstellen"
    handler = "system.createBackup"

# View.Sections.Actions
    [[view.sections.actions]]
    id = "backup_restore"
    label = "Backup Wiederherstellen"
    handler = "system.restoreBackup"
    confirm = true

# Views.Finanzen
[views.finanzen]
id = "finanzen"
title = "Finanzen"
route = "/finanzen"
layout = "tabbed"

# View.Tabs
  [[view.tabs]]
  id = "zahlungen"
  label = "Zahlungen"
  route = "/finanzen/zahlungen"
  table = "tables/zahlungen.table"
  default_sort = { field = "datum", direction = "desc" }

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "datum"
    type = "date_range"
    label = "Zeitraum"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "typ"
    type = "select"

# View.Tabs.Actions
  [view.tabs.actions]
  create = { label = "Zahlung Erfassen", dialog = "forms/zahlung.form" }

# View.Tabs
  [[view.tabs]]
  id = "sollstellung"
  label = "Sollstellung"
  route = "/finanzen/sollstellung"
  table = "tables/sollstellungen.table"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "monat"
    type = "month_picker"
    default = "current"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "status"
    type = "select"

# View.Tabs.Summary
  [view.tabs.summary]
  show = true
  fields = ["sollbetrag", "istbetrag", "differenz"]
  aggregate = "sum"

# View.Tabs
  [[view.tabs]]
  id = "kautionen"
  label = "Kautionen"
  route = "/finanzen/kautionen"
  table = "tables/kautionen.table"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "status"
    type = "select"

# View.Tabs.Summary
  [view.tabs.summary]
  show = true
  fields = ["betrag"]
  aggregate = "sum"
  group_by = "status"

# Views.Mieter
[views.mieter]
id = "mieter"
title = "Mieter"
route = "/mieter"
layout = "list_detail"

# Views.Mieter.List
[views.mieter.list]
table = "tables/mieter.table"
search_fields = ["vorname", "nachname", "email"]
default_sort = { field = "nachname", direction = "asc" }

# View.List.Filters
  [[view.list.filters]]
  field = "status"
  type = "select"
  label = "Status"
  default = "aktiv"

# Views.Mieter.List.Actions
[views.mieter.list.actions]
create = { label = "Mieter Anlegen", dialog = "forms/mieter.form" }

# Views.Mieter.Detail
[views.mieter.detail]
route = "/mieter/:id"
title_field = "computed.display_name"

# View.Detail.Tabs
  [[views.mieter.detail.tabs]]
  id = "stammdaten"
  label = "Stammdaten"
  type = "form_readonly"
  form = "forms/mieter.form"
  edit_action = { dialog = "forms/mieter.form" }

# View.Detail.Tabs
  [[views.mieter.detail.tabs]]
  id = "vertrag"
  label = "Vertrag"
  type = "table"
  table = "tables/vertraege.table"
  filter = { mieter_id = ":id" }

# View.Detail.Tabs
  [[views.mieter.detail.tabs]]
  id = "zahlungen"
  label = "Zahlungen"
  type = "table"
  table = "tables/zahlungen.table"
  filter = { "vertrag.mieter_id" = ":id" }
  actions = { create = { label = "Zahlung Erfassen", dialog = "forms/zahlung.form" } }

# View.Detail.Tabs
  [[views.mieter.detail.tabs]]
  id = "dokumente"
  label = "Dokumente"
  type = "table"
  table = "tables/dokumente.table"
  filter = { mieter_id = ":id" }
  actions = { upload = { label = "Dokument Hochladen", dialog = "forms/dokument.form", defaults = { mieter_id = ":id" } } }

# View.Detail.Tabs
  [[views.mieter.detail.tabs]]
  id = "kaution"
  label = "Kaution"
  type = "form_readonly"
  form = "forms/kaution.form"
  data_path = "aktiver_vertrag.kaution"
  empty_message = "Keine Kaution vorhanden"

# Views.Nebenkosten
[views.nebenkosten]
id = "nebenkosten"
title = "Nebenkosten"
route = "/nebenkosten"
layout = "tabbed"

# View.Tabs
  [[view.tabs]]
  id = "rechnungen"
  label = "Rechnungen"
  route = "/nebenkosten/rechnungen"
  table = "tables/rechnungen.table"
  default_sort = { field = "rechnungsdatum", direction = "desc" }

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "objekt_id"
    type = "select"
    label = "Objekt"
    options_from = "objekt"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "kostenart_id"
    type = "select"
    label = "Kostenart"
    options_from = "kostenart"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "computed.jahr"
    type = "year_picker"
    label = "Jahr"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "computed.ist_bezahlt"
    type = "boolean_toggle"
    label = "Bezahlt"

# View.Tabs.Actions
  [view.tabs.actions]
  create = { label = "Rechnung Erfassen", dialog = "forms/rechnung.form" }

# View.Tabs.Summary
  [view.tabs.summary]
  show = true
  fields = ["betrag"]
  aggregate = "sum"
  group_by = "kostenart.bezeichnung"

# View.Tabs
  [[view.tabs]]
  id = "abrechnungen"
  label = "Abrechnungen"
  route = "/nebenkosten/abrechnungen"
  table = "tables/abrechnungen.table"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "objekt_id"
    type = "select"
    options_from = "objekt"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "jahr"
    type = "year_picker"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "status"
    type = "select"

# View.Tabs.Actions
  [view.tabs.actions]
  create = { label = "Abrechnung Erstellen", dialog = "dialogs/nk_abrechnung_wizard" }

# View.Tabs
  [[view.tabs]]
  id = "zaehler"
  label = "Zaehler"
  route = "/nebenkosten/zaehler"
  table = "tables/zaehler.table"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "objekt_id"
    type = "select"
    options_from = "objekt"

# View.Tabs.Filters
    [[view.tabs.filters]]
    field = "typ"
    type = "select"

# View.Tabs.Actions
  [view.tabs.actions]
  create = { label = "Zaehler Anlegen", dialog = "forms/zaehler.form" }
  ablesung = { label = "Ablesung Erfassen", dialog = "forms/zaehlerstand.form" }

# Views.Objekte
[views.objekte]
id = "objekte"
title = "Objekte"
route = "/objekte"
layout = "list_detail"

# Views.Objekte.List
[views.objekte.list]
table = "tables/objekte.table"
search_fields = ["bezeichnung", "adresse", "ort"]
default_sort = { field = "bezeichnung", direction = "asc" }

# View.List.Filters
  [[view.list.filters]]
  field = "typ"
  type = "select"
  label = "Typ"

# View.List.Filters
  [[view.list.filters]]
  field = "computed.leerstand"
  type = "boolean"
  label = "Mit Leerstand"
  condition = "> 0"

# Views.Objekte.List.Actions
[views.objekte.list.actions]
create = { label = "Objekt Anlegen", dialog = "forms/objekt.form" }

# Views.Objekte.Detail
[views.objekte.detail]
route = "/objekte/:id"
title_field = "bezeichnung"

# View.Detail.Tabs
  [[views.objekte.detail.tabs]]
  id = "stammdaten"
  label = "Stammdaten"
  type = "form_readonly"
  form = "forms/objekt.form"
  edit_action = { dialog = "forms/objekt.form" }

# View.Detail.Tabs
  [[views.objekte.detail.tabs]]
  id = "einheiten"
  label = "Einheiten"
  type = "table"
  table = "tables/einheiten.table"
  filter = { objekt_id = ":id" }
  actions = { create = { label = "Einheit Anlegen", dialog = "forms/einheit.form", defaults = { objekt_id = ":id" } } }

# View.Detail.Tabs
  [[views.objekte.detail.tabs]]
  id = "zaehler"
  label = "Zaehler"
  type = "table"
  table = "tables/zaehler.table"
  filter = { objekt_id = ":id" }
  visible_if = { field = "ist_multi_einheit", equals = true }
  actions = { create = { label = "Zaehler Anlegen", dialog = "forms/zaehler.form", defaults = { objekt_id = ":id" } } }

# View.Detail.Tabs
  [[views.objekte.detail.tabs]]
  id = "rechnungen"
  label = "Rechnungen"
  type = "table"
  table = "tables/rechnungen.table"
  filter = { objekt_id = ":id" }
  actions = { create = { label = "Rechnung Erfassen", dialog = "forms/rechnung.form", defaults = { objekt_id = ":id" } } }

# View.Detail.Tabs
  [[views.objekte.detail.tabs]]
  id = "dokumente"
  label = "Dokumente"
  type = "table"
  table = "tables/dokumente.table"
  filter = { objekt_id = ":id" }
  actions = { upload = { label = "Dokument Hochladen", dialog = "forms/dokument.form", defaults = { objekt_id = ":id" } } }

# Views.Vertraege
[views.vertraege]
id = "vertraege"
title = "Vertr√§ge"
route = "/vertraege"
layout = "list_detail"

# Views.Vertraege.List
[views.vertraege.list]
table = "tables/vertraege.table"
search_fields = ["mieter.nachname", "einheit.bezeichnung", "vertragsnummer"]
default_sort = { field = "beginn", direction = "desc" }

# View.List.Filters
  [[view.list.filters]]
  field = "computed.ist_aktiv"
  type = "boolean_toggle"
  label = "Nur Aktive"
  default = true

# View.List.Filters
  [[view.list.filters]]
  field = "typ"
  type = "select"
  label = "Typ"

# Views.Vertraege.List.Actions
[views.vertraege.list.actions]
create = { label = "Vertrag Anlegen", dialog = "forms/vertrag.form" }

# Views.Vertraege.Detail
[views.vertraege.detail]
route = "/vertraege/:id"
title_field = "vertragsnummer"

# View.Detail.Header Info
  [[view.detail.header_info]]
  fields = ["mieter.computed.display_name", "einheit.bezeichnung", "computed.gesamtmiete"]

# View.Detail.Tabs
  [[views.vertraege.detail.tabs]]
  id = "konditionen"
  label = "Konditionen"
  type = "form_readonly"
  form = "forms/vertrag.form"
  edit_action = { dialog = "forms/vertrag.form" }

# View.Detail.Tabs
  [[views.vertraege.detail.tabs]]
  id = "kaution"
  label = "Kaution"
  type = "form_editable"
  form = "forms/kaution.form"
  data_path = "kaution"

# View.Detail.Tabs
  [[views.vertraege.detail.tabs]]
  id = "zahlungen"
  label = "Zahlungen"
  type = "table"
  table = "tables/zahlungen.table"
  filter = { vertrag_id = ":id" }

# View.Detail.Tabs
  [[views.vertraege.detail.tabs]]
  id = "sollstellung"
  label = "Sollstellung"
  type = "table"
  table = "tables/sollstellungen.table"
  filter = { vertrag_id = ":id" }

# View.Detail.Tabs
  [[views.vertraege.detail.tabs]]
  id = "dokumente"
  label = "Dokumente"
  type = "table"
  table = "tables/dokumente.table"
  filter = { vertrag_id = ":id" }

# =============================================================================
# STATSCARDS - Zentrale Definitionen f√ºr Dashboard Stats Cards
# =============================================================================
[statscards]
# Zentrale Sammlungen von Stats Cards - k√∂nnen in Views referenziert werden
[[statscards.cards]]
id = "objekte"
title = "Objekte"
field = "objekte"
icon = "Building2"
color = "blue"
sortable = true
order = 10

[[statscards.cards]]
id = "mieter"
title = "Mieter"
field = "mieter"
icon = "Users"
color = "green"
sortable = true
order = 20

[[statscards.cards]]
id = "vertraege"
title = "Vertraege"
field = "vertraege"
icon = "FileText"
color = "purple"
sortable = true
order = 30

[[statscards.cards]]
id = "offene_rechnungen"
title = "Offene Rechnungen"
field = "offeneRechnungen"
icon = "Wallet"
color = "orange"
sortable = true
order = 40

[[statscards.cards]]
id = "dokumente"
title = "Dokumente"
field = "dokumente"
icon = "FileArchive"
color = "blue"
sortable = true
order = 50

[[statscards.cards]]
id = "erinnerungen"
title = "Erinnerungen"
field = "offeneErinnerungen"
icon = "FileCheck"
color = "green"
sortable = true
order = 60

# =============================================================================
# IMPORTS - Externe Konfigurationsdateien (Kataloge, Labels, Validierung, Design)
# =============================================================================
# [imports] SECTION REMOVED - All configurations are now consolidated in this file
# Only catalogs remain as separate files in config/catalogs/
# =============================================================================

# =============================================================================
# Compatibility root placeholders (added to satisfy MasterConfigSchema)
# These root sections are intentionally minimal ‚Äî concrete values remain
# in the consolidated `entities`, `forms`, `tables`, `views` sections
# and in the `config/catalogs/` directory for large lookup catalogs.
# =============================================================================

[labels]
# Optional: label overrides / translations can be placed here.
# Example: [labels.ui] greeting = "Willkommen"

[catalogs]
# Katalog-Referenz (Katalogdateien bleiben in config/catalogs/)
# Kataloge werden als einzelne TOML-Dateien in `config/catalogs/` gehalten.

[validation]
# Optional global validation rules. Entity-specific validations remain
# under [entities.<name>.validation]

[features]
# Feature-Flags (optional). Struktur erwartet ein Objekt `features`.
features = {}


# =============================================================================
#
#  ███╗   ███╗██╗███████╗████████╗██╗   ██╗███████╗██████╗ ██╗    ██╗ █████╗ ██╗  ████████╗██╗   ██╗███╗   ██╗ ██████╗
#  ████╗ ████║██║██╔════╝╚══██╔══╝██║   ██║██╔════╝██╔══██╗██║    ██║██╔══██╗██║  ╚══██╔══╝██║   ██║████╗  ██║██╔════╝
#  ██╔████╔██║██║█████╗     ██║   ██║   ██║█████╗  ██████╔╝██║ █╗ ██║███████║██║     ██║   ██║   ██║██╔██╗ ██║██║  ███╗
#  ██║╚██╔╝██║██║██╔══╝     ██║   ╚██╗ ██╔╝██╔══╝  ██╔══██╗██║███╗██║██╔══██║██║     ██║   ██║   ██║██║╚██╗██║██║   ██║
#  ██║ ╚═╝ ██║██║███████╗   ██║    ╚████╔╝ ███████╗██║  ██║╚███╔███╔╝██║  ██║███████╗██║   ╚██████╔╝██║ ╚████║╚██████╔╝
#  ╚═╝     ╚═╝╚═╝╚══════╝   ╚═╝     ╚═══╝  ╚══════╝╚═╝  ╚═╝ ╚══╝╚══╝ ╚═╝  ╚═╝╚══════╝╚═╝    ╚═════╝ ╚═╝  ╚═══╝ ╚═════╝
#
#  MASTER CONFIGURATION
#  100% Config-Driven Property Management System
#
# =============================================================================
# @version: 1.0.0
# @lastModified: 2025-12-17
# @author: Mietverwaltung System
# =============================================================================
#
# Diese Datei ist der zentrale Einstiegspunkt für alle Konfigurationen.
# Alle Module werden hier importiert und zu einer einheitlichen Konfiguration
# zusammengeführt.
#
# STRUKTUR:
# ├── [meta]          - Metadaten der Konfiguration
# ├── [app]           - Anwendungseinstellungen
# ├── [server]        - Server-Konfiguration
# ├── [database]      - Datenbank-Einstellungen
# ├── [imports]       - Import-Definitionen
# ├── [entities]      - Entity-Registrierung
# ├── [navigation]    - Navigationsstruktur
# ├── [labels]        - UI-Texte (i18n)
# ├── [catalogs]      - Wertelisten
# ├── [validation]    - Validierungsregeln
# ├── [design]        - Design-System
# ├── [features]      - Feature-Flags
# └── [routes]        - Routing-Konfiguration
#
# =============================================================================

# =============================================================================
# META - Konfigurationsmetadaten
# =============================================================================
[meta]
version = "1.0.0"
schema_version = "1"
last_modified = "2025-12-17"
environment = "development"  # development | staging | production
config_format = "toml"

# =============================================================================
# APP - Anwendungseinstellungen
# =============================================================================
[app]
name = "Mietverwaltung"
version = "1.0.0"
description = "Private Mietobjekt-Verwaltung"
locale = "de-DE"
currency = "EUR"
timezone = "Europe/Berlin"
date_format = "DD.MM.YYYY"
time_format = "HH:mm"
datetime_format = "DD.MM.YYYY HH:mm"

[app.owner]
# Wird in Einstellungen gepflegt, hier Defaults
name = "Akki Scholze"
address = ""
tax_number = ""
email = ""
phone = ""
iban = ""
bic = ""

[app.defaults]
kuendigungsfrist_monate = 3
kaution_monate = 3
nk_abrechnungsfrist_monate = 12
mieterhoehung_sperrfrist_monate = 15
mahnfrist_tage = 14
zahlungsziel_tage = 14

[app.storage]
dokumente_pfad = "./data/dokumente"
backup_pfad = "./data/backups"
temp_pfad = "./data/temp"
max_upload_size_mb = 25
allowed_file_types = ["pdf", "jpg", "jpeg", "png", "doc", "docx", "xls", "xlsx"]

# =============================================================================
# SERVER - Server-Konfiguration
# =============================================================================
[server]
host = "127.0.0.1"
port = 3002
cors_origin = "http://localhost:5174"
request_timeout_ms = 30000
max_request_size = "50mb"

[server.api]
base_path = "/api"
version = "v1"
rate_limit_requests = 100
rate_limit_window_ms = 60000

[server.static]
enabled = true
path = "./dist/client"
cache_max_age = 86400

# =============================================================================
# DATABASE - Datenbank-Konfiguration
# =============================================================================
[database]
type = "sqlite"
path = "./data/mietverwaltung.db"
wal_mode = true
busy_timeout_ms = 5000
cache_size = -2000  # 2MB

[database.migrations]
enabled = true
path = "./migrations"
auto_run = true

[database.backup]
enabled = true
interval_hours = 24
keep_count = 7
path = "./data/backups"

# =============================================================================
# IMPORTS - Modul-Imports
# =============================================================================
# Definiert welche Konfigurationsdateien geladen werden sollen
# Pfade sind relativ zum config/ Verzeichnis
# =============================================================================
[imports]
# Labels/Internationalisierung
labels = "labels/de.labels.toml"

# Navigation
navigation = "navigation.config.toml"

# Kataloge/Wertelisten
catalogs = [
  "catalogs/status.catalog.toml",
  "catalogs/objekttypen.catalog.toml",
  "catalogs/einheittypen.catalog.toml",
  "catalogs/anrede.catalog.toml",
  "catalogs/zaehlertypen.catalog.toml",
  "catalogs/dokumenttypen.catalog.toml",
  "catalogs/zahlungsarten.catalog.toml",
  "catalogs/prioritaeten.catalog.toml",
  "catalogs/wiederholungen.catalog.toml",
  "catalogs/heizungsarten.catalog.toml",
  "catalogs/kostenarten.catalog.toml",
  "catalogs/umlageschluessel.catalog.toml",
]

# Entities
entities = [
  "entities/objekt.config.toml",
  "entities/einheit.config.toml",
  "entities/mieter.config.toml",
  "entities/vertrag.config.toml",
  "entities/kaution.config.toml",
  "entities/zahlung.config.toml",
  "entities/sollstellung.config.toml",
  "entities/nebenkostenabrechnung.config.toml",
  "entities/zaehler.config.toml",
  "entities/zaehlerstand.config.toml",
  "entities/dokument.config.toml",
  "entities/kostenart.config.toml",
  "entities/rechnung.config.toml",
  "entities/erinnerung.config.toml",
]

# Views
views = [
  "views/dashboard.config.toml",
  "views/objekte.config.toml",
  "views/mieter.config.toml",
  "views/vertraege.config.toml",
  "views/finanzen.config.toml",
  "views/nebenkosten.config.toml",
  "views/dokumente.config.toml",
  "views/einstellungen.config.toml",
]

# Forms
forms = [
  "forms/objekt.form.toml",
  "forms/vertrag.form.toml",
  "forms/kaution.form.toml",
  "forms/zahlung.form.toml",
  "forms/sollstellung.form.toml",
  "forms/zaehler.form.toml",
  "forms/zaehlerstand.form.toml",
  "forms/rechnung.form.toml",
  "forms/nebenkostenabrechnung.form.toml",
  "forms/dokument.form.toml",
]

# Tables
tables = [
  "tables/objekte.table.toml",
  "tables/einheiten.table.toml",
  "tables/mieter.table.toml",
  "tables/vertraege.table.toml",
  "tables/kautionen.table.toml",
  "tables/zahlungen.table.toml",
  "tables/sollstellungen.table.toml",
  "tables/zaehler.table.toml",
  "tables/rechnungen.table.toml",
  "tables/dokumente.table.toml",
  "tables/abrechnungen.table.toml",
]

# Validation
validation = "validation/rules.config.toml"

# Design System
design = [
  "themes/colors.config.toml",
  "themes/design-system.config.toml",
]

# Features
features = "features/feature-flags.config.toml"

# =============================================================================
# ENTITIES - Entity-Registrierung
# =============================================================================
# Zentrale Registrierung aller Datenmodelle
# =============================================================================
[entities]
# Stammdaten
objekt = { config = "entities/objekt", table = "objekte", label = "labels.entities.objekt" }
einheit = { config = "entities/einheit", table = "einheiten", label = "labels.entities.einheit" }
mieter = { config = "entities/mieter", table = "mieter", label = "labels.entities.mieter" }

# Verträge
vertrag = { config = "entities/vertrag", table = "vertraege", label = "labels.entities.vertrag" }
kaution = { config = "entities/kaution", table = "kautionen", label = "labels.entities.kaution" }

# Finanzen
zahlung = { config = "entities/zahlung", table = "zahlungen", label = "labels.entities.zahlung" }
sollstellung = { config = "entities/sollstellung", table = "sollstellungen", label = "labels.entities.sollstellung" }

# Nebenkosten
nebenkostenabrechnung = { config = "entities/nebenkostenabrechnung", table = "nebenkostenabrechnungen", label = "labels.entities.nebenkostenabrechnung" }
zaehler = { config = "entities/zaehler", table = "zaehler", label = "labels.entities.zaehler" }
zaehlerstand = { config = "entities/zaehlerstand", table = "zaehlerstaende", label = "labels.entities.zaehlerstand" }
kostenart = { config = "entities/kostenart", table = "kostenarten", label = "labels.entities.kostenart" }
rechnung = { config = "entities/rechnung", table = "rechnungen", label = "labels.entities.rechnung" }

# Sonstiges
dokument = { config = "entities/dokument", table = "dokumente", label = "labels.entities.dokument" }
erinnerung = { config = "entities/erinnerung", table = "erinnerungen", label = "labels.entities.erinnerung" }

# =============================================================================
# NAVIGATION - Navigationsstruktur
# =============================================================================
[navigation]
default_route = "/dashboard"
mobile_bottom_nav = true
sidebar_collapsible = true
sidebar_default_collapsed = false

[[navigation.items]]
id = "dashboard"
label = "labels.nav.dashboard"
icon = "LayoutDashboard"
route = "/dashboard"
order = 1

[[navigation.items]]
id = "objekte"
label = "labels.nav.objekte"
icon = "Building2"
route = "/objekte"
order = 2
children = [
  { id = "einheiten", label = "labels.nav.einheiten", route = "/objekte/:id/einheiten" }
]

[[navigation.items]]
id = "mieter"
label = "labels.nav.mieter"
icon = "Users"
route = "/mieter"
order = 3

[[navigation.items]]
id = "vertraege"
label = "labels.nav.vertraege"
icon = "FileText"
route = "/vertraege"
order = 4

[[navigation.items]]
id = "finanzen"
label = "labels.nav.finanzen"
icon = "Wallet"
route = "/finanzen"
order = 5
children = [
  { id = "zahlungen", label = "labels.nav.zahlungen", route = "/finanzen/zahlungen" },
  { id = "kautionen", label = "labels.nav.kautionen", route = "/finanzen/kautionen" },
  { id = "sollstellung", label = "labels.nav.sollstellung", route = "/finanzen/sollstellung" },
]

[[navigation.items]]
id = "nebenkosten"
label = "labels.nav.nebenkosten"
icon = "Calculator"
route = "/nebenkosten"
order = 6
children = [
  { id = "rechnungen", label = "labels.nav.rechnungen", route = "/nebenkosten/rechnungen" },
  { id = "abrechnungen", label = "labels.nav.abrechnungen", route = "/nebenkosten/abrechnungen" },
  { id = "zaehler", label = "labels.nav.zaehler", route = "/nebenkosten/zaehler" },
]

[[navigation.items]]
id = "dokumente"
label = "labels.nav.dokumente"
icon = "FolderOpen"
route = "/dokumente"
order = 7

[[navigation.items]]
id = "einstellungen"
label = "labels.nav.einstellungen"
icon = "Settings"
route = "/einstellungen"
order = 99
position = "bottom"

# =============================================================================
# ROUTES - Routing-Konfiguration
# =============================================================================
[routes]
# Basis-Routen
home = "/"
dashboard = "/dashboard"
login = "/login"
not_found = "/404"

# Entity-Routen (generisch)
[routes.patterns]
list = "/{entity}"
detail = "/{entity}/:id"
create = "/{entity}/new"
edit = "/{entity}/:id/edit"

# Spezifische Routen
[routes.custom]
finanzen_zahlungen = "/finanzen/zahlungen"
finanzen_kautionen = "/finanzen/kautionen"
finanzen_sollstellung = "/finanzen/sollstellung"
nebenkosten_rechnungen = "/nebenkosten/rechnungen"
nebenkosten_abrechnungen = "/nebenkosten/abrechnungen"
nebenkosten_zaehler = "/nebenkosten/zaehler"
einheiten_by_objekt = "/objekte/:objekt_id/einheiten"

# =============================================================================
# PAGINATION - Paginierungs-Einstellungen
# =============================================================================
[pagination]
default_page_size = 25
page_size_options = [10, 25, 50, 100]
max_page_size = 100
show_total = true
show_page_jump = true

# =============================================================================
# SEARCH - Such-Einstellungen
# =============================================================================
[search]
min_query_length = 2
debounce_ms = 300
highlight_matches = true
max_suggestions = 10

# Global durchsuchbare Felder pro Entity
[search.fields]
objekt = ["bezeichnung", "strasse", "ort"]
einheit = ["bezeichnung", "einheit_nr"]
mieter = ["vorname", "nachname", "email"]
vertrag = ["vertragsnummer"]
dokument = ["titel", "dateiname"]

# =============================================================================
# EXPORT - Export-Einstellungen
# =============================================================================
[export]
formats = ["csv", "xlsx", "pdf"]
default_format = "xlsx"
include_headers = true
date_format = "DD.MM.YYYY"
decimal_separator = ","
thousands_separator = "."

[export.pdf]
orientation = "landscape"
page_size = "A4"
include_logo = true
include_footer = true

# =============================================================================
# NOTIFICATIONS - Benachrichtigungseinstellungen
# =============================================================================
[notifications]
position = "top-right"
duration_ms = 5000
max_visible = 3
animation = "slide"
closeable = true

[notifications.types]
success = { icon = "CheckCircle", color = "success" }
error = { icon = "XCircle", color = "error" }
warning = { icon = "AlertTriangle", color = "warning" }
info = { icon = "Info", color = "info" }

# =============================================================================
# AUTOSAVE - Auto-Speicherung
# =============================================================================
[autosave]
enabled = true
interval_ms = 30000
show_indicator = true
warn_on_leave = true

# =============================================================================
# KEYBOARD SHORTCUTS - Tastaturkürzel
# =============================================================================
[shortcuts]
enabled = true

[shortcuts.global]
search = "Ctrl+K"
save = "Ctrl+S"
new = "Ctrl+N"
back = "Escape"
help = "F1"

[shortcuts.table]
next_row = "ArrowDown"
prev_row = "ArrowUp"
edit = "Enter"
delete = "Delete"
select_all = "Ctrl+A"

[shortcuts.form]
save = "Ctrl+Enter"
cancel = "Escape"
next_field = "Tab"
prev_field = "Shift+Tab"

# =============================================================================
# LOGGING - Logging-Konfiguration
# =============================================================================
[logging]
level = "info"  # debug | info | warn | error
console = true
file = false
file_path = "./logs/app.log"
max_file_size_mb = 10
max_files = 5

# =============================================================================
# SECURITY - Sicherheitseinstellungen
# =============================================================================
[security]
session_timeout_minutes = 60
max_login_attempts = 5
lockout_duration_minutes = 15
require_https = false  # in Production: true
csp_enabled = true

# =============================================================================
# PERFORMANCE - Performance-Einstellungen
# =============================================================================
[performance]
cache_enabled = true
cache_ttl_seconds = 300
lazy_load_images = true
debounce_input_ms = 300
virtual_scroll_threshold = 100

# =============================================================================
# DEBUG - Debug-Einstellungen (nur Development)
# =============================================================================
[debug]
enabled = true
show_query_time = true
show_render_count = false
log_api_calls = true
mock_delay_ms = 0

# =============================================================================
# END OF CONFIGURATION
# =============================================================================

[view]
id = "objekte"
title = "labels.views.objekte"
route = "/objekte"
layout = "list_detail"

[view.list]
table = "tables/objekte.table"
search_fields = ["bezeichnung", "adresse", "ort"]
default_sort = { field = "bezeichnung", direction = "asc" }

  [[view.list.filters]]
  field = "typ"
  type = "select"
  label = "labels.filter.typ"

  [[view.list.filters]]
  field = "computed.leerstand"
  type = "boolean"
  label = "labels.filter.mit_leerstand"
  condition = "> 0"

[view.list.actions]
create = { label = "labels.actions.objekt_anlegen", dialog = "forms/objekt.form" }

[view.detail]
route = "/objekte/:id"
title_field = "bezeichnung"

  [[view.detail.tabs]]
  id = "stammdaten"
  label = "labels.tabs.stammdaten"
  type = "form_readonly"
  form = "forms/objekt.form"
  edit_action = { dialog = "forms/objekt.form" }

  [[view.detail.tabs]]
  id = "einheiten"
  label = "labels.tabs.einheiten"
  type = "table"
  table = "tables/einheiten.table"
  filter = { objekt_id = ":id" }
  actions = { create = { label = "labels.actions.einheit_anlegen", dialog = "forms/einheit.form", defaults = { objekt_id = ":id" } } }

  [[view.detail.tabs]]
  id = "zaehler"
  label = "labels.tabs.zaehler"
  type = "table"
  table = "tables/zaehler.table"
  filter = { objekt_id = ":id" }
  visible_if = { field = "ist_multi_einheit", equals = true }
  actions = { create = { label = "labels.actions.zaehler_anlegen", dialog = "forms/zaehler.form", defaults = { objekt_id = ":id" } } }

  [[view.detail.tabs]]
  id = "rechnungen"
  label = "labels.tabs.rechnungen"
  type = "table"
  table = "tables/rechnungen.table"
  filter = { objekt_id = ":id" }
  actions = { create = { label = "labels.actions.rechnung_erfassen", dialog = "forms/rechnung.form", defaults = { objekt_id = ":id" } } }

  [[view.detail.tabs]]
  id = "dokumente"
  label = "labels.tabs.dokumente"
  type = "table"
  table = "tables/dokumente.table"
  filter = { objekt_id = ":id" }
  actions = { upload = { label = "labels.actions.dokument_hochladen", dialog = "forms/dokument.form", defaults = { objekt_id = ":id" } } }

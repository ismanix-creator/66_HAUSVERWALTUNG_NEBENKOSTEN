[view]
id = "mieter"
title = "labels.views.mieter"
route = "/mieter"
layout = "list_detail"

[view.list]
table = "tables/mieter.table"
search_fields = ["vorname", "nachname", "email"]
default_sort = { field = "nachname", direction = "asc" }

  [[view.list.filters]]
  field = "status"
  type = "select"
  label = "labels.filter.status"
  default = "aktiv"

[view.list.actions]
create = { label = "labels.actions.mieter_anlegen", dialog = "forms/mieter.form" }

[view.detail]
route = "/mieter/:id"
title_field = "computed.display_name"

  [[view.detail.tabs]]
  id = "stammdaten"
  label = "labels.tabs.stammdaten"
  type = "form_readonly"
  form = "forms/mieter.form"
  edit_action = { dialog = "forms/mieter.form" }

  [[view.detail.tabs]]
  id = "vertrag"
  label = "labels.tabs.vertrag"
  type = "table"
  table = "tables/vertraege.table"
  filter = { mieter_id = ":id" }

  [[view.detail.tabs]]
  id = "zahlungen"
  label = "labels.tabs.zahlungen"
  type = "table"
  table = "tables/zahlungen.table"
  filter = { "vertrag.mieter_id" = ":id" }
  actions = { create = { label = "labels.actions.zahlung_erfassen", dialog = "forms/zahlung.form" } }

  [[view.detail.tabs]]
  id = "dokumente"
  label = "labels.tabs.dokumente"
  type = "table"
  table = "tables/dokumente.table"
  filter = { mieter_id = ":id" }
  actions = { upload = { label = "labels.actions.dokument_hochladen", dialog = "forms/dokument.form", defaults = { mieter_id = ":id" } } }

  [[view.detail.tabs]]
  id = "kaution"
  label = "labels.tabs.kaution"
  type = "form_readonly"
  form = "forms/kaution.form"
  data_path = "aktiver_vertrag.kaution"
  empty_message = "labels.kaution.keine_kaution"

[entity]
name = "objekt"
table_name = "objekte"
label = "labels.entity.objekt"
label_plural = "labels.entity.objekte"
icon = "Building2"
primary_key = "id"

[entity.fields.id]
type = "uuid"
auto_generate = true
visible = false

[entity.fields.bezeichnung]
type = "string"
required = true
max_length = 100
label = "labels.objekt.bezeichnung"
placeholder = "z.B. Haus Musterstraße 12"

[entity.fields.adresse]
type = "string"
required = true
max_length = 200
label = "labels.objekt.adresse"

[entity.fields.plz]
type = "string"
required = true
pattern = "^[0-9]{5}$"
label = "labels.objekt.plz"

[entity.fields.ort]
type = "string"
required = true
max_length = 100
label = "labels.objekt.ort"

[entity.fields.baujahr]
type = "integer"
min = 1800
max = 2100
label = "labels.objekt.baujahr"

[entity.fields.typ]
type = "enum"
required = true
options = ["wohnraum", "gewerbe", "gemischt"]
default = "wohnraum"
label = "labels.objekt.typ"

[entity.fields.ist_multi_einheit]
type = "boolean"
default = false
label = "labels.objekt.ist_multi_einheit"
description = "Mehrere Einheiten mit separaten Zählern"

[entity.fields.notiz]
type = "text"
label = "labels.common.notiz"

[entity.fields.erstellt_am]
type = "datetime"
auto_generate = true
visible_in_form = false
label = "labels.common.erstellt_am"

[entity.relations]
einheiten = { type = "one_to_many", target = "einheit", foreign_key = "objekt_id" }
zaehler = { type = "one_to_many", target = "zaehler", foreign_key = "objekt_id" }
rechnungen = { type = "one_to_many", target = "rechnung", foreign_key = "objekt_id" }
dokumente = { type = "one_to_many", target = "dokument", foreign_key = "objekt_id" }

[entity.computed]
anzahl_einheiten = { formula = "count(einheiten)" }
anzahl_vermietet = { formula = "count(einheiten where status = 'vermietet')" }
leerstand = { formula = "anzahl_einheiten - anzahl_vermietet" }
gesamt_flaeche = { formula = "sum(einheiten.flaeche)" }
